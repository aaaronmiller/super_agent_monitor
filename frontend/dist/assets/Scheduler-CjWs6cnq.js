import{d as $,r as i,o as F,b as l,e as t,g as M,F as g,h as w,k as D,l as f,v as k,B as R,t as r,n as h,f as C,i as a}from"./index-CulLQ6wY.js";import{a as d}from"./api-mlpREBDB.js";import"./index-B9ygI19o.js";const V={class:"container mx-auto px-4 py-8"},B={key:0,class:"text-center py-12"},I={key:1,class:"text-center py-12 bg-white rounded-lg shadow"},W={key:2,class:"grid grid-cols-1 gap-6"},j={class:"flex items-start justify-between"},L={class:"flex items-center gap-4"},U={class:"text-lg font-bold text-gray-900"},q={class:"flex items-center gap-2 text-sm text-gray-500 mt-1"},P={class:"bg-gray-100 px-2 py-0.5 rounded"},z={class:"flex items-center gap-2"},H=["onClick"],G=["onClick"],J=["onClick"],K={class:"mt-4 flex items-center gap-6 text-sm text-gray-500 border-t pt-4"},O={key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Q={class:"bg-white rounded-lg shadow-xl w-full max-w-lg p-6"},X={class:"mb-4"},Y={class:"mb-4"},Z=["value"],tt={class:"mb-4"},et={class:"flex gap-2 mb-2"},st={class:"text-xs text-gray-500 flex gap-2"},ot={class:"flex justify-end gap-3 mt-8"},nt=["disabled"],dt=$({__name:"Scheduler",setup(lt){const p=i([]),v=i([]),b=i(!0),u=i(!1),c=i(!1),n=i({name:"",workflowId:"",cronExpression:""});F(async()=>{await Promise.all([m(),T()])});async function m(){b.value=!0;try{const{data:o}=await d.get("/scheduler/tasks");p.value=o}catch(o){console.error("Failed to load tasks:",o)}finally{b.value=!1}}async function T(){try{const{data:o}=await d.get("/workflows");v.value=o}catch(o){console.error("Failed to load workflows:",o)}}function _(o){var e;return((e=v.value.find(s=>s.id===o))==null?void 0:e.name)||"Unknown Workflow"}function y(){n.value={name:"",workflowId:"",cronExpression:""},u.value=!0}async function S(){c.value=!0;try{await d.post("/scheduler/tasks",n.value),await m(),u.value=!1}catch{alert("Failed to create task")}finally{c.value=!1}}async function A(o){try{await d.patch(`/scheduler/tasks/${o.id}`,{isActive:!o.isActive}),await m()}catch{alert("Failed to update task")}}async function E(o){if(confirm("Are you sure you want to delete this task?"))try{await d.delete(`/scheduler/tasks/${o}`),await m()}catch{alert("Failed to delete task")}}async function N(o){try{await d.post(`/scheduler/tasks/${o.id}/run`),alert("Task started!")}catch{alert("Failed to run task")}}return(o,e)=>(a(),l("div",V,[t("div",{class:"flex justify-between items-center mb-8"},[e[7]||(e[7]=t("div",null,[t("h1",{class:"text-3xl font-bold text-gray-900"},"Task Scheduler"),t("p",{class:"text-gray-600 mt-2"},"Automate your agent workflows with precise timing.")],-1)),t("button",{onClick:y,class:"btn btn-primary"}," + New Scheduled Task ")]),b.value?(a(),l("div",B,[...e[8]||(e[8]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"},null,-1),t("p",{class:"mt-4 text-gray-500"},"Loading tasks...",-1)])])):p.value.length===0?(a(),l("div",I,[e[9]||(e[9]=t("div",{class:"text-6xl mb-4"},"ðŸ•°ï¸",-1)),e[10]||(e[10]=t("h3",{class:"text-xl font-medium text-gray-900"},"No Scheduled Tasks",-1)),e[11]||(e[11]=t("p",{class:"text-gray-500 mt-2"},"Create your first task to run agents automatically.",-1)),t("button",{onClick:y,class:"btn btn-primary mt-6"}," Create Task ")])):(a(),l("div",W,[(a(!0),l(g,null,w(p.value,s=>(a(),l("div",{key:s.id,class:"card hover:shadow-lg transition-shadow"},[t("div",j,[t("div",L,[t("div",{class:h(["p-3 rounded-lg",s.isActive?"bg-green-100 text-green-600":"bg-gray-100 text-gray-500"])},[...e[12]||(e[12]=[t("span",{class:"text-2xl"},"â°",-1)])],2),t("div",null,[t("h3",U,r(s.name),1),t("div",q,[t("code",P,r(s.cronExpression),1),e[13]||(e[13]=t("span",null,"â€¢",-1)),t("span",null,"Workflow: "+r(_(s.workflowId)),1)])])]),t("div",z,[t("button",{onClick:x=>A(s),class:h(["btn btn-sm",s.isActive?"btn-warning":"btn-success"])},r(s.isActive?"Pause":"Resume"),11,H),t("button",{onClick:x=>N(s),class:"btn btn-sm btn-secondary"}," Run Now ",8,G),t("button",{onClick:x=>E(s.id),class:"btn btn-sm btn-danger"}," Delete ",8,J)])]),t("div",K,[t("div",null,[e[14]||(e[14]=t("span",{class:"font-medium"},"Last Run:",-1)),C(" "+r(s.lastRunAt?new Date(s.lastRunAt).toLocaleString():"Never"),1)]),t("div",null,[e[15]||(e[15]=t("span",{class:"font-medium"},"Next Run:",-1)),C(" "+r(s.isActive?"Scheduled":"Paused"),1)])])]))),128))])),u.value?(a(),l("div",O,[t("div",Q,[e[21]||(e[21]=t("h2",{class:"text-2xl font-bold mb-6"},"Create Scheduled Task",-1)),t("form",{onSubmit:D(S,["prevent"])},[t("div",X,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium mb-2"},"Task Name",-1)),f(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>n.value.name=s),type:"text",class:"input w-full",required:"",placeholder:"e.g., Daily Morning Briefing"},null,512),[[k,n.value.name]])]),t("div",Y,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium mb-2"},"Workflow",-1)),f(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>n.value.workflowId=s),class:"input w-full",required:""},[e[17]||(e[17]=t("option",{value:"",disabled:""},"Select a workflow",-1)),(a(!0),l(g,null,w(v.value,s=>(a(),l("option",{key:s.id,value:s.id},r(s.name),9,Z))),128))],512),[[R,n.value.workflowId]])]),t("div",tt,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium mb-2"},"Schedule (Cron Expression)",-1)),t("div",et,[f(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>n.value.cronExpression=s),type:"text",class:"input w-full font-mono",required:"",placeholder:"* * * * *"},null,512),[[k,n.value.cronExpression]]),e[19]||(e[19]=t("a",{href:"https://crontab.guru/",target:"_blank",class:"btn btn-secondary whitespace-nowrap"},"Help",-1))]),t("div",st,[t("button",{type:"button",onClick:e[3]||(e[3]=s=>n.value.cronExpression="0 9 * * *"),class:"hover:text-primary-600 underline"},"Daily 9AM"),t("button",{type:"button",onClick:e[4]||(e[4]=s=>n.value.cronExpression="0 * * * *"),class:"hover:text-primary-600 underline"},"Hourly"),t("button",{type:"button",onClick:e[5]||(e[5]=s=>n.value.cronExpression="*/15 * * * *"),class:"hover:text-primary-600 underline"},"Every 15m")])]),t("div",ot,[t("button",{type:"button",onClick:e[6]||(e[6]=s=>u.value=!1),class:"btn btn-secondary"},"Cancel"),t("button",{type:"submit",class:"btn btn-primary",disabled:c.value},r(c.value?"Creating...":"Create Task"),9,nt)])],32)])])):M("",!0)]))}});export{dt as default};
