import{r as F,c as B,d as Y,w as Z,o as se,a as ie,b as u,e,f as W,g as A,t as d,u as L,F as z,h as H,n as R,i as l,j as ae,T as Be,k as J,l as V,v as je,m as Re,p as X,q as oe,s as De,x as Ne,y as Ue,z as ne,A as qe,B as le,C as Ge,D as Me}from"./index-CulLQ6wY.js";import{_ as Le}from"./_plugin-vue_export-helper-DlAUqK2U.js";class We{constructor(r,t,p){this.animationId=null;const m=r.getContext("2d");if(!m)throw new Error("Failed to get canvas context");this.ctx=m,this.dimensions=t,this.config=p,this.setupCanvas(r)}setupCanvas(r){const t=window.devicePixelRatio||1;r.width=this.dimensions.width*t,r.height=this.dimensions.height*t,r.style.width=`${this.dimensions.width}px`,r.style.height=`${this.dimensions.height}px`,this.ctx.scale(t,t)}getChartArea(){const{width:r,height:t,padding:p}=this.dimensions;return{x:p.left,y:p.top,width:r-p.left-p.right,height:t-p.top-p.bottom}}clear(){this.ctx.clearRect(0,0,this.dimensions.width,this.dimensions.height)}drawBackground(){const r=this.getChartArea(),t=this.ctx.createLinearGradient(r.x,r.y,r.x,r.y+r.height);t.addColorStop(0,"rgba(0, 0, 0, 0.02)"),t.addColorStop(1,"rgba(0, 0, 0, 0.05)"),this.ctx.fillStyle=t,this.ctx.fillRect(r.x,r.y,r.width,r.height)}drawAxes(){const r=this.getChartArea();this.ctx.strokeStyle=this.config.colors.axis,this.ctx.lineWidth=1,this.ctx.beginPath(),this.ctx.moveTo(r.x,r.y+r.height),this.ctx.lineTo(r.x+r.width,r.y+r.height),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(r.x,r.y),this.ctx.lineTo(r.x,r.y+r.height),this.ctx.stroke()}drawTimeLabels(r){const t=this.getChartArea();this.ctx.fillStyle=this.config.colors.text,this.ctx.font="11px system-ui, -apple-system, sans-serif",this.ctx.textAlign="center",this.ctx.textBaseline="top";const p=this.getTimeLabels(r),m=t.width/(p.length-1);p.forEach((i,h)=>{const w=t.x+h*m,f=t.y+t.height+5;this.ctx.fillText(i,w,f)})}getTimeLabels(r){switch(r){case"1m":return["60s","45s","30s","15s","now"];case"3m":return["3m","2m","1m","now"];case"5m":return["5m","4m","3m","2m","1m","now"];case"10m":return["10m","8m","6m","4m","2m","now"];default:return[]}}drawBars(r,t,p=1,m,i){const h=this.getChartArea(),w=this.config.maxDataPoints,f=h.width/w,o=this.config.barWidth;r.forEach((s,y)=>{if(s.count===0)return;const c=h.x+y*f+(f-o)/2,E=s.count/t*h.height*p,g=h.y+h.height-E;let $=this.config.colors.primary;if(i&&s.sessions&&Object.keys(s.sessions).length>0){const T=Object.entries(s.sessions).sort((a,b)=>b[1]-a[1])[0][0];$=i(T)}this.drawBarGlow(c,g,o,E,s.count/t,$),this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(c,g+2),this.ctx.lineTo(c,g+E),this.ctx.lineTo(c+o,g+E),this.ctx.lineTo(c+o,g+2),this.ctx.arcTo(c+o,g,c+o/2,g,2),this.ctx.arcTo(c,g,c,g+2,2),this.ctx.closePath();const I=this.ctx.createLinearGradient(c,g,c,g+E);if(I.addColorStop(0,this.adjustColorOpacity($,.9)),I.addColorStop(.5,$),I.addColorStop(1,this.adjustColorOpacity($,.7)),this.ctx.fillStyle=I,this.ctx.fill(),this.ctx.restore(),m&&s.eventTypes&&Object.keys(s.eventTypes).length>0&&E>10){const T=m(s.eventTypes);if(T){this.ctx.save(),this.ctx.font='20px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Apple Color Emoji", "Segoe UI Emoji", sans-serif';const a=this.ctx.measureText(T),b=8,C=a.width+b*2,x=30,j=c+o/2,S=g+E/2,_=j-C/2,D=S-x/2,O=document.documentElement.classList.contains("dark");this.ctx.fillStyle=O?"rgba(75, 85, 99, 0.95)":"rgba(0, 0, 0, 0.85)",this.ctx.beginPath(),"roundRect"in this.ctx&&typeof this.ctx.roundRect=="function"?this.ctx.roundRect(_,D,C,x,7):(this.ctx.moveTo(_+7,D),this.ctx.lineTo(_+C-7,D),this.ctx.arcTo(_+C,D,_+C,D+7,7),this.ctx.lineTo(_+C,D+x-7),this.ctx.arcTo(_+C,D+x,_+C-7,D+x,7),this.ctx.lineTo(_+7,D+x),this.ctx.arcTo(_,D+x,_,D+x-7,7),this.ctx.lineTo(_,D+7),this.ctx.arcTo(_,D,_+7,D,7),this.ctx.closePath()),this.ctx.fill(),this.ctx.fillStyle="#ffffff",this.ctx.textAlign="left",this.ctx.textBaseline="middle";const M=_+b,N=S;this.ctx.fillText(T,M,N),this.ctx.restore()}}})}drawBarGlow(r,t,p,m,i,h){const w=10+i*20,f=r+p/2,o=t+m/2,s=h||this.config.colors.glow,y=this.ctx.createRadialGradient(f,o,0,f,o,w);y.addColorStop(0,this.adjustColorOpacity(s,.3*i)),y.addColorStop(1,"transparent"),this.ctx.fillStyle=y,this.ctx.fillRect(f-w,o-w,w*2,w*2)}adjustColorOpacity(r,t){if(r.startsWith("#")){const p=parseInt(r.slice(1,3),16),m=parseInt(r.slice(3,5),16),i=parseInt(r.slice(5,7),16);return`rgba(${p}, ${m}, ${i}, ${t})`}return r}drawPulseEffect(r,t,p,m){const i=this.ctx.createRadialGradient(r,t,0,r,t,p);i.addColorStop(0,this.adjustColorOpacity(this.config.colors.primary,m)),i.addColorStop(.5,this.adjustColorOpacity(this.config.colors.primary,m*.5)),i.addColorStop(1,"transparent"),this.ctx.fillStyle=i,this.ctx.beginPath(),this.ctx.arc(r,t,p,0,Math.PI*2),this.ctx.fill()}animate(r){const t=performance.now(),p=m=>{const i=m-t,h=Math.min(i/this.config.animationDuration,1);r(this.easeOut(h)),h<1?this.animationId=requestAnimationFrame(p):this.animationId=null};this.animationId=requestAnimationFrame(p)}easeOut(r){return 1-Math.pow(1-r,3)}stopAnimation(){this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=null)}resize(r){this.dimensions=r,this.setupCanvas(this.ctx.canvas)}}function ze(n){const r=F("1m"),t=F([]),p=F([]);let m=[],i=null;const h=50,w={"1m":{duration:60*1e3,bucketSize:1e3,maxPoints:60},"3m":{duration:3*60*1e3,bucketSize:3e3,maxPoints:60},"5m":{duration:5*60*1e3,bucketSize:5e3,maxPoints:60},"10m":{duration:10*60*1e3,bucketSize:1e4,maxPoints:60}},f=B(()=>w[r.value]),o=O=>{const M=f.value;return Math.floor(O/M.bucketSize)*M.bucketSize},s=()=>{const O=[...m];m=[],p.value.push(...O),O.forEach(M=>{if(!M.timestamp)return;const N=o(M.timestamp);let P=t.value.find(U=>U.timestamp===N);P?(P.count++,P.eventTypes||(P.eventTypes={}),P.eventTypes[M.hook_event_type]=(P.eventTypes[M.hook_event_type]||0)+1,P.sessions||(P.sessions={}),P.sessions[M.session_id]=(P.sessions[M.session_id]||0)+1):t.value.push({timestamp:N,count:1,eventTypes:{[M.hook_event_type]:1},sessions:{[M.session_id]:1}})}),c(),E()},y=O=>{m.push(O),i!==null&&clearTimeout(i),i=window.setTimeout(()=>{s(),i=null},h)},c=()=>{const M=Date.now()-f.value.duration;t.value=t.value.filter(N=>N.timestamp>=M),t.value.length>f.value.maxPoints&&(t.value=t.value.slice(-f.value.maxPoints))},E=()=>{const M=Date.now()-5*60*1e3;p.value=p.value.filter(N=>N.timestamp&&N.timestamp>=M)},g=()=>{const O=Date.now(),M=f.value,N=O-M.duration,P=[];for(let U=N;U<=O;U+=M.bucketSize){const k=o(U),v=t.value.find(q=>q.timestamp===k);P.push({timestamp:k,count:(v==null?void 0:v.count)||0,eventTypes:(v==null?void 0:v.eventTypes)||{},sessions:(v==null?void 0:v.sessions)||{}})}return P.slice(-M.maxPoints)},$=O=>{r.value=O,I()},I=()=>{t.value=[];const M=Date.now()-f.value.duration;p.value.filter(P=>P.timestamp&&P.timestamp>=M).forEach(P=>{if(!P.timestamp)return;const U=o(P.timestamp);let k=t.value.find(v=>v.timestamp===U);k?(k.count++,k.eventTypes[P.hook_event_type]=(k.eventTypes[P.hook_event_type]||0)+1,k.sessions[P.session_id]=(k.sessions[P.session_id]||0)+1):t.value.push({timestamp:U,count:1,eventTypes:{[P.hook_event_type]:1},sessions:{[P.session_id]:1}})}),c()},T=setInterval(()=>{c(),E()},1e3),a=()=>{clearInterval(T),i!==null&&(clearTimeout(i),s())},b=()=>{t.value=[],p.value=[],m=[],i!==null&&(clearTimeout(i),i=null)},C=(O,M)=>`${O}:${M.slice(0,8)}`,x=B(()=>{const O=Date.now(),M=f.value,N=O-M.duration,P=new Set;return p.value.forEach(U=>{if(U.timestamp&&U.timestamp>=N){const k=C(U.source_app,U.session_id);P.add(k)}}),Array.from(P)}),j=B(()=>{const O=new Set;return p.value.forEach(M=>{const N=C(M.source_app,M.session_id);O.add(N)}),Array.from(O)}),S=B(()=>x.value.length),_=B(()=>t.value.reduce((O,M)=>{var N;return O+(((N=M.eventTypes)==null?void 0:N.PreToolUse)||0)},0)),D=B(()=>{const O=Date.now(),M=f.value,N=O-M.duration,P=p.value.filter(G=>G.timestamp&&G.timestamp>=N).sort((G,K)=>(G.timestamp||0)-(K.timestamp||0));if(P.length<2)return{minGap:0,maxGap:0,avgGap:0};const U=[];for(let G=1;G<P.length;G++){const K=(P[G].timestamp||0)-(P[G-1].timestamp||0);K>0&&U.push(K)}if(U.length===0)return{minGap:0,maxGap:0,avgGap:0};const k=Math.min(...U),v=Math.max(...U),q=U.reduce((G,K)=>G+K,0)/U.length;return{minGap:k,maxGap:v,avgGap:q}});return{timeRange:r,dataPoints:t,addEvent:y,getChartData:g,setTimeRange:$,cleanup:a,clearData:b,currentConfig:f,uniqueAgentCount:S,uniqueAgentIdsInWindow:x,allUniqueAgentIds:j,toolCallCount:_,eventTimingMetrics:D}}const Pe={PreToolUse:"ðŸ”§",PostToolUse:"âœ…",Notification:"ðŸ””",Stop:"ðŸ›‘",SubagentStop:"ðŸ‘¥",PreCompact:"ðŸ“¦",UserPromptSubmit:"ðŸ’¬",SessionStart:"ðŸš€",SessionEnd:"ðŸ",default:"â“"};function He(){const n=t=>Pe[t]||Pe.default;return{getEmojiForEventType:n,formatEventTypeLabel:t=>{const p=Object.entries(t).sort((i,h)=>h[1]-i[1]);return p.length===0?"":p.slice(0,3).map(([i,h])=>{const w=n(i);return h>1?`${w}Ã—${h}`:w}).join("")}}}function Fe(){const n=["bg-blue-500","bg-green-500","bg-yellow-500","bg-purple-500","bg-pink-500","bg-indigo-500","bg-red-500","bg-orange-500","bg-teal-500","bg-cyan-500"],r=o=>{let s=7151;for(let y=0;y<o.length;y++)s=(s<<5)+s+o.charCodeAt(y);return Math.abs(s>>>0)},t=o=>{const y=r(o)%n.length;return n[y]},p=o=>{const y=r(o)%n.length;return n[y]},m=o=>{const s=t(o);return`bg-gradient-to-r ${{"bg-blue-500":"from-blue-500 to-blue-600","bg-green-500":"from-green-500 to-green-600","bg-yellow-500":"from-yellow-500 to-yellow-600","bg-purple-500":"from-purple-500 to-purple-600","bg-pink-500":"from-pink-500 to-pink-600","bg-indigo-500":"from-indigo-500 to-indigo-600","bg-red-500":"from-red-500 to-red-600","bg-orange-500":"from-orange-500 to-orange-600","bg-teal-500":"from-teal-500 to-teal-600","bg-cyan-500":"from-cyan-500 to-cyan-600"}[s]||"from-gray-500 to-gray-600"}`},i=o=>{const s=p(o);return`bg-gradient-to-r ${{"bg-blue-500":"from-blue-500 to-blue-600","bg-green-500":"from-green-500 to-green-600","bg-yellow-500":"from-yellow-500 to-yellow-600","bg-purple-500":"from-purple-500 to-purple-600","bg-pink-500":"from-pink-500 to-pink-600","bg-indigo-500":"from-indigo-500 to-indigo-600","bg-red-500":"from-red-500 to-red-600","bg-orange-500":"from-orange-500 to-orange-600","bg-teal-500":"from-teal-500 to-teal-600","bg-cyan-500":"from-cyan-500 to-cyan-600"}[s]||"from-gray-500 to-gray-600"}`},h=o=>({"bg-blue-500":"#3B82F6","bg-green-500":"#22C55E","bg-yellow-500":"#EAB308","bg-purple-500":"#A855F7","bg-pink-500":"#EC4899","bg-indigo-500":"#6366F1","bg-red-500":"#EF4444","bg-orange-500":"#F97316","bg-teal-500":"#14B8A6","bg-cyan-500":"#06B6D4"})[o]||"#3B82F6";return{getColorForSession:t,getColorForApp:p,getGradientForSession:m,getGradientForApp:i,getHexColorForSession:o=>{const s=t(o);return h(s)},getHexColorForApp:o=>`hsl(${r(o)%360}, 70%, 50%)`}}const Je={class:"bg-gradient-to-r from-[var(--theme-bg-primary)] to-[var(--theme-bg-secondary)] p-4 mobile:p-2 rounded-lg shadow-lg border border-[var(--theme-border-primary)]"},Ve={class:"flex items-center justify-between mb-4 mobile:mb-2"},Ke={class:"flex items-center space-x-3 mobile:space-x-2"},Qe={class:"flex items-center space-x-2 mobile:space-x-1"},Ye={class:"px-3 mobile:px-2 py-1 bg-[var(--theme-bg-tertiary)] rounded-full text-sm mobile:text-xs font-semibold text-[var(--theme-text-primary)] border border-[var(--theme-border-primary)] shadow-sm"},Xe={class:"text-[var(--theme-primary)] font-bold"},Ze={class:"px-3 mobile:px-2 py-1 bg-[var(--theme-bg-tertiary)] rounded-full text-sm mobile:text-xs font-semibold text-[var(--theme-text-primary)] border border-[var(--theme-border-primary)] shadow-sm"},et={class:"text-[var(--theme-primary)] font-bold"},tt={key:0,class:"px-3 mobile:px-2 py-1 bg-[var(--theme-bg-tertiary)] rounded-full text-sm mobile:text-xs font-semibold text-[var(--theme-text-primary)] border border-[var(--theme-border-primary)] shadow-sm"},ot={class:"text-[var(--theme-primary)] font-bold"},st={class:"flex bg-[var(--theme-bg-tertiary)] rounded-lg p-1 shadow-inner"},rt=["onClick"],at={class:"relative h-48 mobile:h-40 w-full bg-[var(--theme-bg-tertiary)] rounded-lg border border-[var(--theme-border-primary)] overflow-hidden shadow-inner"},nt={key:0,class:"absolute inset-0 flex items-center justify-center text-[var(--theme-text-tertiary)]"},lt={class:"mt-3 grid grid-cols-3 gap-4 mobile:gap-2 text-xs text-[var(--theme-text-secondary)]"},it={class:"text-center p-2 bg-[var(--theme-bg-tertiary)] rounded-lg border border-[var(--theme-border-primary)]"},dt={class:"block font-bold text-[var(--theme-primary)]"},ut={class:"text-center p-2 bg-[var(--theme-bg-tertiary)] rounded-lg border border-[var(--theme-border-primary)]"},ct={class:"block font-bold text-[var(--theme-primary)]"},mt={class:"text-center p-2 bg-[var(--theme-bg-tertiary)] rounded-lg border border-[var(--theme-border-primary)]"},pt={class:"block font-bold text-[var(--theme-primary)]"},ht=Y({__name:"LivePulseChart",props:{events:{}},emits:["update:uniqueAgentIds","update:allAgentIds"],setup(n,{emit:r}){const t=n,p=F(null);let m=null,i=null;const{timeRange:h,dataPoints:w,addEvent:f,getChartData:o,setTimeRange:s,cleanup:y,clearData:c,uniqueAgentCount:E,uniqueAgentIdsInWindow:g,allUniqueAgentIds:$,toolCallCount:I,eventTimingMetrics:T}=ze(),{getEmojiForEventType:a}=He(),{getHexColorForSession:b}=Fe(),C=r;Z(g,S=>{C("update:uniqueAgentIds",Array.from(S))}),Z($,S=>{C("update:allAgentIds",Array.from(S))}),Z(()=>t.events,(S,_)=>{S.length>((_==null?void 0:_.length)||0)?S.slice((_==null?void 0:_.length)||0).forEach(O=>{f(O)}):S.length===0&&((_==null?void 0:_.length)||0)>0&&c()},{deep:!0});const x=S=>a(S),j=()=>{if(!m||!p.value)return;const S=o(),_=Math.max(...S.map(D=>D.count),1);m.clear(),m.drawBackground(),m.drawAxes(),m.drawTimeLabels(h.value),m.drawBars(S,_,1,x,b),i=requestAnimationFrame(j)};return se(()=>{p.value&&(m=new We(p.value,{colors:{primary:"#3b82f6",glow:"#60a5fa",axis:"#9ca3af",text:"#6b7280"}}),j(),window.addEventListener("resize",()=>{m&&m.resize()}),t.events.length>0&&t.events.forEach(S=>f(S)))}),ie(()=>{i&&cancelAnimationFrame(i),y(),window.removeEventListener("resize",()=>{m&&m.resize()})}),(S,_)=>(l(),u("div",Je,[e("div",Ve,[e("div",Ke,[_[3]||(_[3]=e("h2",{class:"text-xl mobile:text-lg font-bold text-[var(--theme-primary)] drop-shadow-sm flex items-center"},[e("span",{class:"mr-2 text-2xl mobile:text-xl animate-pulse"},"ðŸ’“"),W(" Live Pulse ")],-1)),e("div",Qe,[e("span",Ye,[e("span",Xe,d(L(E)),1),_[0]||(_[0]=W(" Active Agents ",-1))]),e("span",Ze,[e("span",et,d(L(w).length),1),_[1]||(_[1]=W(" Events ",-1))]),L(I)>0?(l(),u("span",tt,[e("span",ot,d(L(I)),1),_[2]||(_[2]=W(" Tool Calls ",-1))])):A("",!0)])]),e("div",st,[(l(),u(z,null,H(["1m","3m","5m","10m"],D=>e("button",{key:D,onClick:O=>L(s)(D),class:R(["px-3 mobile:px-2 py-1 rounded-md text-sm mobile:text-xs font-medium transition-all duration-200",L(h)===D?"bg-[var(--theme-primary)] text-white shadow-md transform scale-105":"text-[var(--theme-text-secondary)] hover:text-[var(--theme-text-primary)] hover:bg-[var(--theme-bg-primary)]"])},d(D),11,rt)),64))])]),e("div",at,[e("canvas",{ref_key:"canvas",ref:p,class:"absolute inset-0 w-full h-full"},null,512),L(w).length===0?(l(),u("div",nt,[..._[4]||(_[4]=[e("div",{class:"flex flex-col items-center animate-pulse"},[e("span",{class:"text-3xl mb-2"},"ðŸ“¡"),e("span",{class:"font-medium"},"Waiting for events...")],-1)])])):A("",!0)]),e("div",lt,[e("div",it,[e("span",dt,d(L(T).eventsPerSecond.toFixed(1)),1),_[5]||(_[5]=e("span",{class:"text-[var(--theme-text-tertiary)]"},"Events/sec",-1))]),e("div",ut,[e("span",ct,d(L(T).peakEventsPerSecond.toFixed(1)),1),_[6]||(_[6]=e("span",{class:"text-[var(--theme-text-tertiary)]"},"Peak/sec",-1))]),e("div",mt,[e("span",pt,d(L(T).avgTimeBetweenEvents.toFixed(0))+"ms",1),_[7]||(_[7]=e("span",{class:"text-[var(--theme-text-tertiary)]"},"Avg Interval",-1))])])]))}});function gt(){const n=F(0);let r=null,t=null;const p=700,m=B(()=>n.value<p),i=B(()=>n.value>=p&&n.value<1024),h=B(()=>n.value>=1024),w=()=>{r&&clearTimeout(r),r=window.setTimeout(()=>{n.value=window.innerWidth},100)},f=o=>{n.value=window.innerWidth};return se(()=>{typeof window<"u"&&(n.value=window.innerWidth,t=window.matchMedia(`(max-width: ${p-1}px)`),t.addEventListener?t.addEventListener("change",f):t.addListener(f),window.addEventListener("resize",w))}),ie(()=>{r&&clearTimeout(r),t&&(t.removeEventListener?t.removeEventListener("change",f):t.removeListener(f)),typeof window<"u"&&window.removeEventListener("resize",w)}),{windowWidth:B(()=>n.value),isMobile:m,isTablet:i,isDesktop:h,MOBILE_BREAKPOINT:p}}const vt={class:"bg-white dark:bg-gray-800 rounded-lg p-4 h-full overflow-y-auto space-y-3 border-2 border-gray-300 dark:border-gray-600"},bt={key:0,class:"p-3 rounded-lg bg-blue-50 dark:bg-blue-900/30"},yt={class:"flex items-start justify-between"},xt={class:"flex items-start space-x-3 flex-1"},ft={class:"flex-1"},kt={key:0,class:"text-lg text-gray-800 dark:text-gray-100 whitespace-pre-wrap font-medium"},wt={key:1,class:"space-y-2"},_t={key:0,class:"text-lg text-gray-800 dark:text-gray-100 whitespace-pre-wrap font-medium"},Ct={key:1,class:"bg-gray-100 dark:bg-gray-900 p-2 rounded"},$t={class:"text-sm text-gray-700 dark:text-gray-300 mt-1"},St={key:2,class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},Tt={class:"flex items-center space-x-1 ml-2"},At=["onClick"],Et=["onClick"],It={key:0,class:"mt-3 p-3 bg-gray-100 dark:bg-gray-900 rounded-lg"},Mt={class:"text-xs text-gray-700 dark:text-gray-300 overflow-x-auto"},Pt={key:1,class:"p-3 rounded-lg bg-gray-50 dark:bg-gray-900/30"},jt={class:"flex items-start justify-between"},Lt={class:"flex items-start space-x-3 flex-1"},Ft={class:"flex-1"},Ot={key:0,class:"space-y-2"},Bt={key:0,class:"text-lg text-gray-800 dark:text-gray-100 whitespace-pre-wrap font-medium"},Rt={key:1,class:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded border border-yellow-200 dark:border-yellow-800"},Dt={class:"flex items-center space-x-2 mb-2"},Nt={class:"font-semibold text-yellow-800 dark:text-yellow-200"},Ut={class:"text-sm text-gray-700 dark:text-gray-300 overflow-x-auto"},qt={key:1,class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},Gt={key:2,class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Wt={class:"flex items-center space-x-1 ml-2"},zt=["onClick"],Ht=["onClick"],Jt={key:0,class:"mt-3 p-3 bg-gray-100 dark:bg-gray-900 rounded-lg"},Vt={class:"text-xs text-gray-700 dark:text-gray-300 overflow-x-auto"},Kt={key:2,class:"p-3 rounded-lg bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800"},Qt={class:"flex items-start justify-between"},Yt={class:"flex items-start space-x-3 flex-1"},Xt={class:"flex-1"},Zt={class:"text-lg text-gray-800 dark:text-gray-100 font-medium"},eo={key:0,class:"mt-1 text-xs text-gray-500 dark:text-gray-400 font-mono"},to={key:1,class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},oo={class:"flex items-center space-x-1 ml-2"},so=["onClick"],ro=["onClick"],ao={key:0,class:"mt-3 p-3 bg-gray-100 dark:bg-gray-900 rounded-lg"},no={class:"text-xs text-gray-700 dark:text-gray-300 overflow-x-auto"},lo={class:"flex items-start justify-between"},io={class:"flex items-start space-x-3 flex-1"},uo={class:"flex-1"},co={class:"text-lg text-gray-800 dark:text-gray-100 whitespace-pre-wrap font-medium"},mo={class:"flex items-center space-x-1 ml-2"},po=["onClick"],ho=["onClick"],go={key:0,class:"mt-3 p-3 bg-gray-100 dark:bg-gray-900 rounded-lg"},vo={class:"text-xs text-gray-700 dark:text-gray-300 overflow-x-auto"},bo=Y({__name:"ChatTranscript",props:{chat:{}},setup(n){const r=n,t=F(new Set),p=c=>{t.value.has(c)?t.value.delete(c):t.value.add(c),t.value=new Set(t.value)},m=c=>t.value.has(c),i=B(()=>(r.chat.length>0&&r.chat[0].type,r.chat)),h=c=>new Date(c).toLocaleTimeString(),w=c=>c.replace(/\u001b\[[0-9;]*m/g,""),f=c=>c.replace(/<command-message>.*?<\/command-message>/gs,"").replace(/<command-name>(.*?)<\/command-name>/gs,"$1").trim(),o=F(new Map),s=c=>o.value.get(c)||"ðŸ“‹",y=async(c,E)=>{const g=i.value[c];try{const $=JSON.stringify(g,null,2);await navigator.clipboard.writeText($),o.value.set(c,"âœ…"),setTimeout(()=>{o.value.delete(c),o.value=new Map(o.value)},2e3)}catch($){console.error("Failed to copy:",$),o.value.set(c,"âŒ"),setTimeout(()=>{o.value.delete(c),o.value=new Map(o.value)},2e3)}o.value=new Map(o.value)};return(c,E)=>(l(),u("div",vt,[(l(!0),u(z,null,H(i.value,(g,$)=>(l(),u("div",{key:$},[g.type==="user"&&g.message?(l(),u("div",bt,[e("div",yt,[e("div",xt,[E[1]||(E[1]=e("span",{class:"text-lg font-semibold px-3 py-1 rounded-full flex-shrink-0 bg-blue-500 text-white"}," User ",-1)),e("div",ft,[typeof g.message.content=="string"?(l(),u("p",kt,d(g.message.content.includes("<command-")?f(g.message.content):g.message.content),1)):Array.isArray(g.message.content)?(l(),u("div",wt,[(l(!0),u(z,null,H(g.message.content,(I,T)=>(l(),u("div",{key:T},[I.type==="text"?(l(),u("p",_t,d(I.text),1)):I.type==="tool_result"?(l(),u("div",Ct,[E[0]||(E[0]=e("span",{class:"text-sm font-mono text-gray-600 dark:text-gray-400"},"Tool Result:",-1)),e("pre",$t,d(I.content),1)])):A("",!0)]))),128))])):A("",!0),g.timestamp?(l(),u("div",St,d(h(g.timestamp)),1)):A("",!0)])]),e("div",Tt,[e("button",{onClick:I=>p($),class:"px-2 py-1 text-xs font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors"},d(m($)?"Hide":"Show")+" Details ",9,At),e("button",{onClick:I=>y($,g.type||g.role),class:"px-2 py-1 text-xs font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors flex items-center",title:"Copy message"},d(s($)),9,Et)])]),m($)?(l(),u("div",It,[e("pre",Mt,d(JSON.stringify(g,null,2)),1)])):A("",!0)])):g.type==="assistant"&&g.message?(l(),u("div",Pt,[e("div",jt,[e("div",Lt,[E[3]||(E[3]=e("span",{class:"text-lg font-semibold px-3 py-1 rounded-full flex-shrink-0 bg-gray-500 text-white"}," Assistant ",-1)),e("div",Ft,[Array.isArray(g.message.content)?(l(),u("div",Ot,[(l(!0),u(z,null,H(g.message.content,(I,T)=>(l(),u("div",{key:T},[I.type==="text"?(l(),u("p",Bt,d(I.text),1)):I.type==="tool_use"?(l(),u("div",Rt,[e("div",Dt,[E[2]||(E[2]=e("span",{class:"text-2xl"},"ðŸ”§",-1)),e("span",Nt,d(I.name),1)]),e("pre",Ut,d(JSON.stringify(I.input,null,2)),1)])):A("",!0)]))),128))])):A("",!0),g.message.usage?(l(),u("div",qt," Tokens: "+d(g.message.usage.input_tokens)+" in / "+d(g.message.usage.output_tokens)+" out ",1)):A("",!0),g.timestamp?(l(),u("div",Gt,d(h(g.timestamp)),1)):A("",!0)])]),e("div",Wt,[e("button",{onClick:I=>p($),class:"px-2 py-1 text-xs font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors"},d(m($)?"Hide":"Show")+" Details ",9,zt),e("button",{onClick:I=>y($,g.type||g.role),class:"px-2 py-1 text-xs font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors flex items-center",title:"Copy message"},d(s($)),9,Ht)])]),m($)?(l(),u("div",Jt,[e("pre",Vt,d(JSON.stringify(g,null,2)),1)])):A("",!0)])):g.type==="system"?(l(),u("div",Kt,[e("div",Qt,[e("div",Yt,[E[4]||(E[4]=e("span",{class:"text-lg font-semibold px-3 py-1 rounded-full flex-shrink-0 bg-amber-600 text-white"}," System ",-1)),e("div",Xt,[e("p",Zt,d(w(g.content||"")),1),g.toolUseID?(l(),u("div",eo," Tool ID: "+d(g.toolUseID),1)):A("",!0),g.timestamp?(l(),u("div",to,d(h(g.timestamp)),1)):A("",!0)])]),e("div",oo,[e("button",{onClick:I=>p($),class:"px-2 py-1 text-xs font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors"},d(m($)?"Hide":"Show")+" Details ",9,so),e("button",{onClick:I=>y($,g.type||g.role),class:"px-2 py-1 text-xs font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors flex items-center",title:"Copy message"},d(s($)),9,ro)])]),m($)?(l(),u("div",ao,[e("pre",no,d(JSON.stringify(g,null,2)),1)])):A("",!0)])):g.role?(l(),u("div",{key:3,class:R(["p-3 rounded-lg",g.role==="user"?"bg-blue-50 dark:bg-blue-900/30":"bg-gray-50 dark:bg-gray-900/30"])},[e("div",lo,[e("div",io,[e("span",{class:R(["text-lg font-semibold px-3 py-1 rounded-full flex-shrink-0",g.role==="user"?"bg-blue-500 text-white":"bg-gray-500 text-white"])},d(g.role==="user"?"User":"Assistant"),3),e("div",uo,[e("p",co,d(g.content),1)])]),e("div",mo,[e("button",{onClick:I=>p($),class:"px-2 py-1 text-xs font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors"},d(m($)?"Hide":"Show")+" Details ",9,po),e("button",{onClick:I=>y($,g.type||g.role),class:"px-2 py-1 text-xs font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors flex items-center",title:"Copy message"},d(s($)),9,ho)])]),m($)?(l(),u("div",go,[e("pre",vo,d(JSON.stringify(g,null,2)),1)])):A("",!0)],2)):A("",!0)]))),128))]))}}),yo={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 mobile:p-0"},xo={class:"flex-shrink-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-6 mobile:p-3"},fo={class:"space-y-4"},ko={class:"flex gap-2"},wo={class:"relative flex-1"},_o={class:"flex flex-wrap gap-2 mobile:gap-1 max-h-24 mobile:max-h-32 overflow-y-auto p-2 mobile:p-1 bg-gray-50 dark:bg-gray-900/50 rounded-lg mobile:overflow-x-auto mobile:pb-2"},Co=["onClick"],$o={class:"mr-1"},So={key:0,class:"text-sm mobile:text-xs text-gray-500 dark:text-gray-400"},To={key:0,class:"ml-2 font-medium mobile:block mobile:ml-0 mobile:mt-1"},Ao={class:"flex-1 p-6 mobile:p-3 overflow-hidden flex flex-col"},Eo=Y({__name:"ChatTranscriptModal",props:{isOpen:{type:Boolean},chat:{}},emits:["close"],setup(n,{emit:r}){const t=n,p=r,m=F(""),i=F(""),h=F([]),w=F("ðŸ“‹ Copy All"),f=[{type:"user",label:"User",icon:"ðŸ‘¤"},{type:"assistant",label:"Assistant",icon:"ðŸ¤–"},{type:"system",label:"System",icon:"âš™ï¸"},{type:"tool_use",label:"Tool Use",icon:"ðŸ”§"},{type:"tool_result",label:"Tool Result",icon:"âœ…"},{type:"Read",label:"Read",icon:"ðŸ“„"},{type:"Write",label:"Write",icon:"âœï¸"},{type:"Edit",label:"Edit",icon:"âœï¸"},{type:"Glob",label:"Glob",icon:"ðŸ”Ž"}],o=a=>{const b=h.value.indexOf(a);b>-1?h.value.splice(b,1):h.value.push(a)},s=()=>{i.value=m.value},y=()=>{m.value="",i.value="",h.value=[]},c=()=>{p("close")},E=async()=>{try{const a=JSON.stringify(t.chat,null,2);await navigator.clipboard.writeText(a),w.value="âœ… Copied!",setTimeout(()=>{w.value="ðŸ“‹ Copy All"},2e3)}catch(a){console.error("Failed to copy all messages:",a),w.value="âŒ Failed",setTimeout(()=>{w.value="ðŸ“‹ Copy All"},2e3)}},g=(a,b)=>{const C=b.toLowerCase().trim();if(typeof a.content=="string"&&a.content.replace(/\u001b\[[0-9;]*m/g,"").toLowerCase().includes(C)||a.role&&a.role.toLowerCase().includes(C))return!0;if(a.message){if(a.message.role&&a.message.role.toLowerCase().includes(C))return!0;if(a.message.content){if(typeof a.message.content=="string"&&a.message.content.toLowerCase().includes(C))return!0;if(Array.isArray(a.message.content)){for(const x of a.message.content)if(x.text&&x.text.toLowerCase().includes(C)||x.name&&x.name.toLowerCase().includes(C)||x.input&&JSON.stringify(x.input).toLowerCase().includes(C)||x.content&&typeof x.content=="string"&&x.content.toLowerCase().includes(C))return!0}}}return!!(a.type&&a.type.toLowerCase().includes(C)||a.uuid&&a.uuid.toLowerCase().includes(C)||a.sessionId&&a.sessionId.toLowerCase().includes(C)||a.toolUseResult&&JSON.stringify(a.toolUseResult).toLowerCase().includes(C))},$=a=>{var b,C,x;if(h.value.length===0||a.type&&h.value.includes(a.type)||a.role&&h.value.includes(a.role))return!0;if(a.type==="system"&&a.content){const j=(b=a.content.match(/([A-Za-z]+):/))==null?void 0:b[1];if(j&&h.value.includes(j)||a.content.includes("Running")&&h.value.includes("Running"))return!0;const S=["Read","Write","Edit","Glob"];for(const _ of S)if(a.content.includes(_)&&h.value.includes(_))return!0}if((C=a.message)!=null&&C.content&&typeof a.message.content=="string"&&a.message.content.includes("<command-")&&h.value.includes("command")||a.isMeta&&h.value.includes("meta"))return!0;if((x=a.message)!=null&&x.content&&Array.isArray(a.message.content)){for(const j of a.message.content)if(j.type==="tool_use"&&(h.value.includes("tool_use")||j.name&&h.value.includes(j.name))||j.type==="tool_result"&&h.value.includes("tool_result"))return!0}return!1},I=B(()=>!i.value&&h.value.length===0?t.chat:t.chat.filter(a=>{const b=!i.value||g(a,i.value),C=$(a);return b&&C})),T=a=>{a.key==="Escape"&&t.isOpen&&c()};return se(()=>{document.addEventListener("keydown",T)}),ie(()=>{document.removeEventListener("keydown",T)}),Z(()=>t.isOpen,a=>{a||y()}),(a,b)=>(l(),ae(Be,{to:"body"},[n.isOpen?(l(),u("div",yo,[e("div",{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:c}),e("div",{class:R(["relative bg-white dark:bg-gray-800 rounded-lg mobile:rounded-none shadow-xl flex flex-col overflow-hidden z-10 mobile:w-full mobile:h-full mobile:fixed mobile:inset-0",{"mobile:!w-full mobile:!h-full":!0}]),style:{width:"85vw",height:"85vh"},onClick:b[1]||(b[1]=J(()=>{},["stop"]))},[e("div",xo,[e("div",{class:"flex items-center justify-between mb-4 mobile:mb-2"},[b[3]||(b[3]=e("h2",{class:"text-3xl mobile:text-lg font-semibold text-gray-900 dark:text-white"}," ðŸ’¬ Chat Transcript ",-1)),e("button",{onClick:c,class:"p-2 mobile:p-3 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors min-w-[44px] min-h-[44px] flex items-center justify-center"},[...b[2]||(b[2]=[e("svg",{class:"w-6 h-6 mobile:w-5 mobile:h-5 text-gray-500 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",fo,[e("div",ko,[e("div",wo,[V(e("input",{"onUpdate:modelValue":b[0]||(b[0]=C=>m.value=C),onKeyup:Re(s,["enter"]),type:"text",placeholder:"Search transcript...",class:"w-full px-4 py-2 mobile:px-3 mobile:py-2 pl-10 mobile:pl-8 text-lg mobile:text-base border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"},null,544),[[je,m.value]]),b[4]||(b[4]=e("svg",{class:"absolute left-3 top-3 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))]),e("button",{onClick:s,class:"px-4 py-2 mobile:px-3 mobile:py-2 bg-blue-500 hover:bg-blue-600 text-white font-medium rounded-lg transition-colors text-base mobile:text-sm min-w-[44px] min-h-[44px] flex items-center justify-center"}," Search "),e("button",{onClick:E,class:"px-4 py-2 mobile:px-3 mobile:py-2 bg-gray-500 hover:bg-gray-600 text-white font-medium rounded-lg transition-colors text-base mobile:text-sm min-w-[44px] min-h-[44px] flex items-center justify-center",title:"Copy all messages as JSON"},d(w.value),1)]),e("div",_o,[(l(),u(z,null,H(f,C=>e("button",{key:C.type,onClick:x=>o(C.type),class:R(["px-4 py-2 mobile:px-3 mobile:py-1.5 rounded-full text-sm mobile:text-xs font-medium transition-colors min-h-[44px] mobile:min-h-[36px] flex items-center whitespace-nowrap",h.value.includes(C.type)?"bg-blue-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"])},[e("span",$o,d(C.icon),1),W(" "+d(C.label),1)],10,Co)),64)),m.value||i.value||h.value.length>0?(l(),u("button",{key:0,onClick:y,class:"px-4 py-2 mobile:px-3 mobile:py-1.5 rounded-full text-sm mobile:text-xs font-medium bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 hover:bg-red-200 dark:hover:bg-red-900/50 min-h-[44px] mobile:min-h-[36px] flex items-center whitespace-nowrap"}," Clear All ")):A("",!0)]),i.value||h.value.length>0?(l(),u("div",So,[W(" Showing "+d(I.value.length)+" of "+d(n.chat.length)+" messages ",1),i.value?(l(),u("span",To,' (searching for "'+d(i.value)+'") ',1)):A("",!0)])):A("",!0)])]),e("div",Ao,[X(bo,{chat:I.value},null,8,["chat"])])])])):A("",!0)]))}}),Io={class:"mb-3"},Mo={class:"flex items-center justify-between mb-2"},Po={class:"flex items-center space-x-2"},jo={class:"text-2xl"},Lo={key:0,class:"text-xs font-mono font-semibold px-2 py-1 rounded border-2 bg-blue-50 dark:bg-blue-900/20 border-blue-500 text-blue-900 dark:text-blue-100"},Fo={key:0,class:"text-xs font-semibold text-yellow-700 dark:text-yellow-300"},Oo={class:"flex items-center space-x-2 ml-9"},Bo={class:"text-xs text-[var(--theme-text-tertiary)] font-medium"},Ro={class:"text-base font-medium text-gray-900 dark:text-gray-100"},Do={key:0,class:"mb-4 p-3 bg-white dark:bg-gray-800 rounded-lg border border-green-400"},No={key:0,class:"text-gray-900 dark:text-gray-100 ml-7"},Uo={key:1,class:"text-gray-900 dark:text-gray-100 ml-7"},qo={key:2,class:"text-gray-900 dark:text-gray-100 ml-7"},Go={key:1},Wo={class:"flex justify-end space-x-2 mt-2"},zo=["disabled"],Ho={key:2},Jo={class:"flex justify-end items-center space-x-3"},Vo={key:0,class:"flex items-center px-3 py-2 bg-green-100 dark:bg-green-900/30 rounded-lg border border-green-500"},Ko=["disabled"],Qo=["disabled"],Yo={key:3},Xo={class:"flex flex-wrap gap-2 justify-end"},Zo=["onClick","disabled"],es={class:"ml-4"},ts={class:"hidden mobile:block mb-2"},os={class:"flex items-center justify-between mb-1"},ss={class:"text-xs text-[var(--theme-text-tertiary)] font-medium"},rs={class:"flex items-center space-x-2"},as=["title"],ns={class:"inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-bold bg-[var(--theme-primary)] text-white shadow-md"},ls={class:"mr-1 text-sm"},is={class:"flex items-center justify-between mb-2 mobile:hidden"},ds={class:"flex items-center space-x-4"},us=["title"],cs={class:"inline-flex items-center px-3 py-0.5 rounded-full text-sm font-bold bg-[var(--theme-primary)] text-white shadow-lg"},ms={class:"mr-1.5 text-base"},ps={class:"text-sm text-[var(--theme-text-tertiary)] font-semibold"},hs={class:"flex items-center justify-between mb-2 mobile:hidden"},gs={key:0,class:"text-base text-[var(--theme-text-secondary)] font-semibold flex-1"},vs={class:"font-medium italic px-2 py-0.5 rounded border-2 border-[var(--theme-primary)] bg-[var(--theme-primary-light)] shadow-sm"},bs={key:1,class:"flex-1"},ys={class:"mr-1"},xs={class:"space-y-2 hidden mobile:block mb-2"},fs={key:0,class:"text-sm text-[var(--theme-text-secondary)] font-semibold w-full"},ks={class:"font-medium italic px-1.5 py-0.5 rounded border-2 border-[var(--theme-primary)] bg-[var(--theme-primary-light)] shadow-sm"},ws={class:"mr-1"},_s={key:0,class:"mt-2 pt-2 border-t-2 border-[var(--theme-primary)] bg-gradient-to-r from-[var(--theme-bg-primary)] to-[var(--theme-bg-secondary)] rounded-b-lg p-3 space-y-3"},Cs={class:"flex items-center justify-between mb-2"},$s={class:"text-sm mobile:text-xs text-[var(--theme-text-primary)] bg-[var(--theme-bg-tertiary)] p-3 mobile:p-2 rounded-lg overflow-x-auto max-h-64 overflow-y-auto font-mono border border-[var(--theme-primary)]/30 shadow-md hover:shadow-lg transition-shadow duration-200"},Ss={key:0,class:"flex justify-end"},Ts=["disabled"],As={class:"text-sm mobile:text-xs font-bold drop-shadow-sm"},Es=Y({__name:"EventRow",props:{event:{},gradientClass:{},colorClass:{},appGradientClass:{},appColorClass:{},appHexColor:{}},emits:["response-submitted"],setup(n,{emit:r}){const t=n,p=r,m=F(!1),i=F(!1),h=F("ðŸ“‹ Copy"),w=F(""),f=F(!1),o=F(!1),s=F(null),{isMobile:y}=gt(),c=()=>{m.value=!m.value},E=B(()=>t.event.session_id.slice(0,8)),g=B(()=>{var v,q;const k=t.event.payload;return!!(t.event.hook_event_type==="SubagentStart"||t.event.hook_event_type==="SubagentStop"||((v=k.tool_input)==null?void 0:v.file_path)===".summary-prompt.txt"||(q=k.tool_input)!=null&&q.command&&(k.tool_input.command.includes("/events/batch-summaries")||k.tool_input.command.includes("/events/save-summary-prompt")||k.tool_input.command.includes(".summary-prompt.txt")))}),$=B(()=>t.event.summary?t.event.summary.startsWith("[Meta-event:")?t.event.summary:g.value?`[Meta-event: ${t.event.summary}`:t.event.summary:null),I=B(()=>({PreToolUse:"ðŸ”§",PostToolUse:"âœ…",Notification:"ðŸ””",Stop:"ðŸ›‘",SubagentStop:"ðŸ‘¥",PreCompact:"ðŸ“¦",UserPromptSubmit:"ðŸ’¬",SessionStart:"ðŸš€",SessionEnd:"ðŸ"})[t.event.hook_event_type]||"â“"),T=B(()=>t.colorClass.replace("bg-","border-")),a=B(()=>({borderColor:t.appHexColor})),b=B(()=>({backgroundColor:t.appHexColor+"33"})),C=B(()=>JSON.stringify(t.event.payload,null,2)),x=B(()=>{const k=t.event.payload;if(t.event.hook_event_type==="UserPromptSubmit"&&k.prompt)return{tool:"Prompt:",detail:`"${k.prompt.slice(0,100)}${k.prompt.length>100?"...":""}"`};if(t.event.hook_event_type==="PreCompact")return{tool:"Compaction:",detail:(k.trigger||"unknown")==="manual"?"Manual compaction":"Auto-compaction (full context)"};if(t.event.hook_event_type==="SessionStart"){const v=k.source||"unknown";return{tool:"Session:",detail:{startup:"New session",resume:"Resuming session",clear:"Fresh session"}[v]||v}}if(k.tool_name){const v={tool:k.tool_name};return k.tool_input&&(k.tool_input.command?v.detail=k.tool_input.command.slice(0,50)+(k.tool_input.command.length>50?"...":""):k.tool_input.file_path?v.detail=k.tool_input.file_path.split("/").pop():k.tool_input.pattern&&(v.detail=k.tool_input.pattern)),v}return null}),j=k=>k?new Date(k).toLocaleTimeString():"",S=k=>{if(!k)return"";const v=k.split("-");return v.length>=4?`${v[1]}-${v[2]}-${v[3]}`:k},_=async()=>{try{await navigator.clipboard.writeText(C.value),h.value="âœ… Copied!",setTimeout(()=>{h.value="ðŸ“‹ Copy"},2e3)}catch(k){console.error("Failed to copy:",k),h.value="âŒ Failed",setTimeout(()=>{h.value="ðŸ“‹ Copy"},2e3)}},D=B(()=>t.event.humanInTheLoop?{question:"â“",permission:"ðŸ”",choice:"ðŸŽ¯"}[t.event.humanInTheLoop.type]||"â“":""),O=B(()=>t.event.humanInTheLoop?{question:"Agent Question",permission:"Permission Request",choice:"Choice Required"}[t.event.humanInTheLoop.type]||"Question":""),M=B(()=>{var k;return((k=t.event.payload)==null?void 0:k.permission_type)||null}),N=async()=>{if(!w.value.trim()||!t.event.id)return;const k={response:w.value.trim(),hookEvent:t.event,respondedAt:Date.now()};s.value=k,o.value=!0;const v=w.value;w.value="",f.value=!0;try{if(!(await fetch(`http://localhost:3001/events/${t.event.id}/respond`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)})).ok)throw new Error("Failed to submit response");p("response-submitted",k)}catch(q){console.error("Error submitting response:",q),s.value=null,o.value=!1,w.value=v,alert("Failed to submit response. Please try again.")}finally{f.value=!1}},P=async k=>{if(!t.event.id)return;const v={permission:k,hookEvent:t.event,respondedAt:Date.now()};s.value=v,o.value=!0,f.value=!0;try{if(!(await fetch(`http://localhost:3001/events/${t.event.id}/respond`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(v)})).ok)throw new Error("Failed to submit permission");p("response-submitted",v)}catch(q){console.error("Error submitting permission:",q),s.value=null,o.value=!1,alert("Failed to submit permission. Please try again.")}finally{f.value=!1}},U=async k=>{if(!t.event.id)return;const v={choice:k,hookEvent:t.event,respondedAt:Date.now()};s.value=v,o.value=!0,f.value=!0;try{if(!(await fetch(`http://localhost:3001/events/${t.event.id}/respond`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(v)})).ok)throw new Error("Failed to submit choice");p("response-submitted",v)}catch(q){console.error("Error submitting choice:",q),s.value=null,o.value=!1,alert("Failed to submit choice. Please try again.")}finally{f.value=!1}};return(k,v)=>{var q,G,K,de,ue,ce,me,pe,he,ge,ve,be,ye,xe,fe,ke,we,_e,Ce,$e,Se,Te,Ae,Ee,Ie;return l(),u("div",null,[n.event.humanInTheLoop&&(((q=n.event.humanInTheLoopStatus)==null?void 0:q.status)==="pending"||o.value)?(l(),u("div",{key:0,class:R(["mb-4 p-4 rounded-lg border-2 shadow-lg",o.value||((G=n.event.humanInTheLoopStatus)==null?void 0:G.status)==="responded"?"border-green-500 bg-gradient-to-r from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20":"border-yellow-500 bg-gradient-to-r from-yellow-50 to-yellow-100 dark:from-yellow-900/20 dark:to-yellow-800/20 animate-pulse-slow"]),onClick:v[4]||(v[4]=J(()=>{},["stop"]))},[e("div",Io,[e("div",Mo,[e("div",Po,[e("span",jo,d(D.value),1),e("h3",{class:R(["text-lg font-bold",o.value||((K=n.event.humanInTheLoopStatus)==null?void 0:K.status)==="responded"?"text-green-900 dark:text-green-100":"text-yellow-900 dark:text-yellow-100"])},d(O.value),3),M.value?(l(),u("span",Lo,d(M.value),1)):A("",!0)]),!o.value&&((de=n.event.humanInTheLoopStatus)==null?void 0:de.status)!=="responded"?(l(),u("span",Fo," â±ï¸ Waiting for response... ")):A("",!0)]),e("div",Oo,[e("span",{class:"text-xs font-semibold text-[var(--theme-text-primary)] px-1.5 py-0.5 rounded-full border-2 bg-[var(--theme-bg-tertiary)] shadow-sm",style:oe({...b.value,...a.value})},d(n.event.source_app),5),e("span",{class:R(["text-xs text-[var(--theme-text-secondary)] px-1.5 py-0.5 rounded-full border bg-[var(--theme-bg-tertiary)]/50 shadow-sm",T.value])},d(E.value),3),e("span",Bo,d(j(n.event.timestamp)),1)])]),e("div",{class:R(["mb-4 p-3 bg-white dark:bg-gray-800 rounded-lg border",o.value||((ue=n.event.humanInTheLoopStatus)==null?void 0:ue.status)==="responded"?"border-green-300":"border-yellow-300"])},[e("p",Ro,d(n.event.humanInTheLoop.question),1)],2),s.value||((ce=n.event.humanInTheLoopStatus)==null?void 0:ce.status)==="responded"&&n.event.humanInTheLoopStatus.response?(l(),u("div",Do,[v[7]||(v[7]=e("div",{class:"flex items-center mb-2"},[e("span",{class:"text-xl mr-2"},"âœ…"),e("strong",{class:"text-green-900 dark:text-green-100"},"Your Response:")],-1)),(me=s.value)!=null&&me.response||(he=(pe=n.event.humanInTheLoopStatus)==null?void 0:pe.response)!=null&&he.response?(l(),u("div",No,d(((ge=s.value)==null?void 0:ge.response)||((be=(ve=n.event.humanInTheLoopStatus)==null?void 0:ve.response)==null?void 0:be.response)),1)):A("",!0),((ye=s.value)==null?void 0:ye.permission)!==void 0||((fe=(xe=n.event.humanInTheLoopStatus)==null?void 0:xe.response)==null?void 0:fe.permission)!==void 0?(l(),u("div",Uo,d(((ke=s.value)==null?void 0:ke.permission)??((_e=(we=n.event.humanInTheLoopStatus)==null?void 0:we.response)==null?void 0:_e.permission)?"Approved âœ…":"Denied âŒ"),1)):A("",!0),(Ce=s.value)!=null&&Ce.choice||(Se=($e=n.event.humanInTheLoopStatus)==null?void 0:$e.response)!=null&&Se.choice?(l(),u("div",qo,d(((Te=s.value)==null?void 0:Te.choice)||((Ee=(Ae=n.event.humanInTheLoopStatus)==null?void 0:Ae.response)==null?void 0:Ee.choice)),1)):A("",!0)])):A("",!0),n.event.humanInTheLoop.type==="question"?(l(),u("div",Go,[V(e("textarea",{"onUpdate:modelValue":v[0]||(v[0]=Q=>w.value=Q),class:"w-full p-3 border-2 border-yellow-500 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent resize-none",rows:"3",placeholder:"Type your response here...",onClick:v[1]||(v[1]=J(()=>{},["stop"]))},null,512),[[je,w.value]]),e("div",Wo,[e("button",{onClick:J(N,["stop"]),disabled:!w.value.trim()||f.value||o.value,class:"px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white font-bold rounded-lg transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 disabled:transform-none disabled:cursor-not-allowed"},d(f.value?"â³ Sending...":"âœ… Submit Response"),9,zo)])])):n.event.humanInTheLoop.type==="permission"?(l(),u("div",Ho,[e("div",Jo,[o.value||((Ie=n.event.humanInTheLoopStatus)==null?void 0:Ie.status)==="responded"?(l(),u("div",Vo,[...v[8]||(v[8]=[e("span",{class:"text-sm font-bold text-green-900 dark:text-green-100"},"Responded",-1)])])):A("",!0),e("button",{onClick:v[2]||(v[2]=J(Q=>P(!1),["stop"])),disabled:f.value||o.value,class:R(["px-6 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105",o.value?"opacity-40 cursor-not-allowed":""])},d(f.value?"â³":"âŒ Deny"),11,Ko),e("button",{onClick:v[3]||(v[3]=J(Q=>P(!0),["stop"])),disabled:f.value||o.value,class:R(["px-6 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105",o.value?"opacity-40 cursor-not-allowed":""])},d(f.value?"â³":"âœ… Approve"),11,Qo)])])):n.event.humanInTheLoop.type==="choice"?(l(),u("div",Yo,[e("div",Xo,[(l(!0),u(z,null,H(n.event.humanInTheLoop.choices,Q=>(l(),u("button",{key:Q,onClick:J(Tr=>U(Q),["stop"]),disabled:f.value||o.value,class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-bold rounded-lg transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 disabled:transform-none"},d(f.value?"â³":Q),9,Zo))),128))])])):A("",!0)],2)):A("",!0),n.event.humanInTheLoop?A("",!0):(l(),u("div",{key:1,class:R(["group relative p-4 mobile:p-2 rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer border border-[var(--theme-border-primary)] hover:border-[var(--theme-primary)] bg-gradient-to-r from-[var(--theme-bg-primary)] to-[var(--theme-bg-secondary)]",{"ring-2 ring-[var(--theme-primary)] border-[var(--theme-primary)] shadow-2xl":m.value}]),onClick:c},[e("div",{class:"absolute left-0 top-0 bottom-0 w-3 rounded-l-lg",style:oe({backgroundColor:n.appHexColor})},null,4),e("div",{class:R(["absolute left-3 top-0 bottom-0 w-1.5",n.gradientClass])},null,2),e("div",es,[e("div",ts,[e("div",os,[e("span",{class:"text-xs font-semibold text-[var(--theme-text-primary)] px-1.5 py-0.5 rounded-full border-2 bg-[var(--theme-bg-tertiary)] shadow-md",style:oe({...b.value,...a.value})},d(n.event.source_app),5),e("span",ss,d(j(n.event.timestamp)),1)]),e("div",rs,[e("span",{class:R(["text-xs text-[var(--theme-text-secondary)] px-1.5 py-0.5 rounded-full border bg-[var(--theme-bg-tertiary)]/50",T.value])},d(E.value),3),n.event.model_name?(l(),u("span",{key:0,class:"text-xs text-[var(--theme-text-secondary)] px-1.5 py-0.5 rounded-full border bg-[var(--theme-bg-tertiary)]/50 shadow-sm",title:`Model: ${n.event.model_name}`},[v[9]||(v[9]=e("span",{class:"mr-0.5"},"ðŸ§ ",-1)),W(d(S(n.event.model_name)),1)],8,as)):A("",!0),e("span",ns,[e("span",ls,d(I.value),1),W(" "+d(n.event.hook_event_type),1)])])]),e("div",is,[e("div",ds,[e("span",{class:"text-base font-bold text-[var(--theme-text-primary)] px-2 py-0.5 rounded-full border-2 bg-[var(--theme-bg-tertiary)] shadow-lg",style:oe({...b.value,...a.value})},d(n.event.source_app),5),e("span",{class:R(["text-sm text-[var(--theme-text-secondary)] px-2 py-0.5 rounded-full border bg-[var(--theme-bg-tertiary)]/50 shadow-md",T.value])},d(E.value),3),n.event.model_name?(l(),u("span",{key:0,class:"text-sm text-[var(--theme-text-secondary)] px-2 py-0.5 rounded-full border bg-[var(--theme-bg-tertiary)]/50 shadow-md",title:`Model: ${n.event.model_name}`},[v[10]||(v[10]=e("span",{class:"mr-1"},"ðŸ§ ",-1)),W(d(S(n.event.model_name)),1)],8,us)):A("",!0),e("span",cs,[e("span",ms,d(I.value),1),W(" "+d(n.event.hook_event_type),1)])]),e("span",ps,d(j(n.event.timestamp)),1)]),e("div",hs,[x.value?(l(),u("div",gs,[e("span",vs,d(x.value.tool),1),x.value.detail?(l(),u("span",{key:0,class:R(["ml-2 text-[var(--theme-text-tertiary)]",{italic:n.event.hook_event_type==="UserPromptSubmit"}])},d(x.value.detail),3)):A("",!0)])):(l(),u("div",bs)),$.value?(l(),u("div",{key:2,class:R(["max-w-[50%] px-3 py-1.5 rounded-lg shadow-md",$.value.startsWith("[Meta-event:")?"bg-orange-100 dark:bg-orange-900/20 border border-orange-500/50":"bg-[var(--theme-primary)]/10 border border-[var(--theme-primary)]/30"])},[e("span",{class:R(["text-sm font-semibold",$.value.startsWith("[Meta-event:")?"text-orange-700 dark:text-orange-300":"text-[var(--theme-text-primary)]"])},[e("span",ys,d($.value.startsWith("[Meta-event:")?"âš ï¸":"ðŸ“"),1),W(" "+d($.value),1)],2)],2)):A("",!0)]),e("div",xs,[x.value?(l(),u("div",fs,[e("span",ks,d(x.value.tool),1),x.value.detail?(l(),u("span",{key:0,class:R(["ml-2 text-[var(--theme-text-tertiary)]",{italic:n.event.hook_event_type==="UserPromptSubmit"}])},d(x.value.detail),3)):A("",!0)])):A("",!0),$.value?(l(),u("div",{key:1,class:R(["w-full px-2 py-1 rounded-lg shadow-md",$.value.startsWith("[Meta-event:")?"bg-orange-100 dark:bg-orange-900/20 border border-orange-500/50":"bg-[var(--theme-primary)]/10 border border-[var(--theme-primary)]/30"])},[e("span",{class:R(["text-xs font-semibold",$.value.startsWith("[Meta-event:")?"text-orange-700 dark:text-orange-300":"text-[var(--theme-text-primary)]"])},[e("span",ws,d($.value.startsWith("[Meta-event:")?"âš ï¸":"ðŸ“"),1),W(" "+d($.value),1)],2)],2)):A("",!0)]),m.value?(l(),u("div",_s,[e("div",null,[e("div",Cs,[v[11]||(v[11]=e("h4",{class:"text-base mobile:text-sm font-bold text-[var(--theme-primary)] drop-shadow-sm flex items-center"},[e("span",{class:"mr-1.5 text-xl mobile:text-base"},"ðŸ“¦"),W(" Payload ")],-1)),e("button",{onClick:J(_,["stop"]),class:"px-3 py-1 mobile:px-2 mobile:py-0.5 text-sm mobile:text-xs font-bold rounded-lg bg-[var(--theme-primary)] hover:bg-[var(--theme-primary-dark)] text-white transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 flex items-center space-x-1"},[e("span",null,d(h.value),1)])]),e("pre",$s,d(C.value),1)]),n.event.chat&&n.event.chat.length>0?(l(),u("div",Ss,[e("button",{onClick:v[5]||(v[5]=J(Q=>!L(y)&&(i.value=!0),["stop"])),class:R(["px-4 py-2 mobile:px-3 mobile:py-1.5 font-bold rounded-lg transition-all duration-200 flex items-center space-x-1.5 shadow-md hover:shadow-lg",L(y)?"bg-[var(--theme-bg-quaternary)] cursor-not-allowed opacity-50 text-[var(--theme-text-quaternary)] border border-[var(--theme-border-tertiary)]":"bg-gradient-to-r from-[var(--theme-primary)] to-[var(--theme-primary-light)] hover:from-[var(--theme-primary-dark)] hover:to-[var(--theme-primary)] text-white border border-[var(--theme-primary-dark)] transform hover:scale-105"]),disabled:L(y)},[v[12]||(v[12]=e("span",{class:"text-base mobile:text-sm"},"ðŸ’¬",-1)),e("span",As,d(L(y)?"Not available in mobile":`View Chat Transcript (${n.event.chat.length} messages)`),1)],10,Ts)])):A("",!0)])):A("",!0)])],2)),n.event.chat&&n.event.chat.length>0?(l(),ae(Eo,{key:2,"is-open":i.value,chat:n.event.chat,onClose:v[6]||(v[6]=Q=>i.value=!1)},null,8,["is-open","chat"])):A("",!0)])}}}),Is=Le(Es,[["__scopeId","data-v-e8bb04b6"]]);function Ms(){const n=F(""),r=F(""),t=o=>{if(!o||o.trim()==="")return{valid:!0};try{return new RegExp(o),{valid:!0}}catch(s){return{valid:!1,error:s instanceof Error?s.message:"Invalid regex pattern"}}},p=o=>{const s=[];return o.hook_event_type&&s.push(o.hook_event_type),o.source_app&&s.push(o.source_app),o.session_id&&s.push(o.session_id),o.model&&s.push(o.model),o.tool_name&&s.push(o.tool_name),o.tool_command&&s.push(o.tool_command),o.tool_file&&o.tool_file.path&&s.push(o.tool_file.path),o.summary&&s.push(o.summary),o.hitl_question&&s.push(o.hitl_question),o.hitl_permission&&s.push(o.hitl_permission),s.join(" ").toLowerCase()},m=(o,s)=>{if(!s||s.trim()==="")return!0;if(!t(s).valid)return!1;try{const c=new RegExp(s,"i"),E=p(o);return c.test(E)}catch{return!1}},i=(o,s)=>!s||s.trim()===""?o:o.filter(y=>m(y,s)),h=B(()=>r.value.length>0);return{searchPattern:n,searchError:r,hasError:h,validateRegex:t,matchesPattern:m,searchEvents:i,updateSearchPattern:o=>{if(n.value=o,!o||o.trim()===""){r.value="";return}const s=t(o);s.valid?r.value="":r.value=s.error||"Invalid regex pattern"},clearSearch:()=>{n.value="",r.value=""},getSearchableText:p}}const Ps={class:"flex-1 mobile:h-[50vh] overflow-hidden flex flex-col"},js={class:"px-3 py-4 mobile:py-2 bg-gradient-to-r from-[var(--theme-bg-primary)] to-[var(--theme-bg-secondary)] relative z-10",style:{"box-shadow":"0 4px 20px -2px rgba(0, 0, 0, 0.3), 0 8px 25px -5px rgba(0, 0, 0, 0.2)"}},Ls={key:0,class:"mt-3 flex flex-wrap gap-2 mobile:gap-1.5 justify-start"},Fs=["onClick","title"],Os={class:"mr-2"},Bs={class:"font-mono text-sm"},Rs={class:"mt-3 mobile:mt-2 w-full"},Ds={class:"flex items-center gap-2 mobile:gap-1"},Ns={class:"relative flex-1"},Us=["value"],qs={key:0,class:"mt-1.5 mobile:mt-1 px-2 py-1.5 mobile:py-1 bg-[var(--theme-accent-error)]/10 border border-[var(--theme-accent-error)] rounded-lg text-xs mobile:text-[11px] text-[var(--theme-accent-error)] font-semibold",role:"alert"},Gs={key:0,class:"text-center py-8 mobile:py-6 text-[var(--theme-text-tertiary)]"},Ws=Y({__name:"EventTimeline",props:{events:{},filters:{},stickToBottom:{type:Boolean},uniqueAppNames:{},allAppNames:{}},emits:["update:stickToBottom","selectAgent"],setup(n,{emit:r}){const t=n,p=r,m=F(),{getGradientForSession:i,getColorForSession:h,getGradientForApp:w,getColorForApp:f,getHexColorForApp:o}=Fe(),{searchPattern:s,searchError:y,searchEvents:c,updateSearchPattern:E,clearSearch:g}=Ms(),$=B(()=>{var x;return(x=t.allAppNames)!=null&&x.length?t.allAppNames:t.uniqueAppNames||[]}),I=x=>x.split(":")[0],T=x=>(t.uniqueAppNames||[]).includes(x),a=B(()=>{let x=t.events.filter(j=>!(t.filters.sourceApp&&j.source_app!==t.filters.sourceApp||t.filters.sessionId&&j.session_id!==t.filters.sessionId||t.filters.eventType&&j.hook_event_type!==t.filters.eventType));return s.value&&(x=c(x,s.value)),x}),b=()=>{m.value&&(m.value.scrollTop=m.value.scrollHeight)},C=()=>{if(!m.value)return;const{scrollTop:x,scrollHeight:j,clientHeight:S}=m.value,_=j-x-S<50;_!==t.stickToBottom&&p("update:stickToBottom",_)};return Z(()=>t.events.length,async()=>{t.stickToBottom&&(await Ue(),b())}),Z(()=>t.stickToBottom,x=>{x&&b()}),(x,j)=>(l(),u("div",Ps,[e("div",js,[j[3]||(j[3]=e("h2",{class:"text-2xl mobile:text-lg font-bold text-[var(--theme-primary)] text-center drop-shadow-sm"}," Agent Event Stream ",-1)),$.value.length>0?(l(),u("div",Ls,[(l(!0),u(z,null,H($.value,S=>(l(),u("button",{key:S,onClick:_=>p("selectAgent",S),class:R(["text-base mobile:text-sm font-bold px-3 mobile:px-2 py-1 rounded-full border-2 shadow-lg transition-all duration-200 hover:shadow-xl hover:scale-105 cursor-pointer",T(S)?"text-[var(--theme-text-primary)] bg-[var(--theme-bg-tertiary)]":"text-[var(--theme-text-tertiary)] bg-[var(--theme-bg-tertiary)] opacity-50 hover:opacity-75"]),style:oe({borderColor:L(o)(I(S)),backgroundColor:L(o)(I(S))+(T(S)?"33":"1a")}),title:`${T(S)?"Active: Click to add":"Sleeping: No recent events. Click to add"} ${S} to comparison lanes`},[e("span",Os,d(T(S)?"âœ¨":"ðŸ˜´"),1),e("span",Bs,d(S),1)],14,Fs))),128))])):A("",!0),e("div",Rs,[e("div",Ds,[e("div",Ns,[e("input",{type:"text",value:L(s),onInput:j[0]||(j[0]=S=>L(E)(S.target.value)),placeholder:"Search events (regex enabled)... e.g., 'tool.*error' or '^GET'",class:R(["w-full px-3 mobile:px-2 py-2 mobile:py-1.5 rounded-lg text-sm mobile:text-xs font-mono border-2 transition-all duration-200","bg-[var(--theme-bg-tertiary)] text-[var(--theme-text-primary)] placeholder-[var(--theme-text-quaternary)]","border-[var(--theme-border-primary)] focus:border-[var(--theme-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--theme-primary)]/20",L(y)?"border-[var(--theme-accent-error)]":""]),"aria-label":"Search events with regex pattern"},null,42,Us),L(s)?(l(),u("button",{key:0,onClick:j[1]||(j[1]=(...S)=>L(g)&&L(g)(...S)),class:"absolute right-2 top-1/2 transform -translate-y-1/2 text-[var(--theme-text-tertiary)] hover:text-[var(--theme-primary)] transition-colors duration-200",title:"Clear search","aria-label":"Clear search"}," âœ• ")):A("",!0)])]),L(y)?(l(),u("div",qs,[j[2]||(j[2]=e("span",{class:"inline-block mr-1"},"âš ï¸",-1)),W(" "+d(L(y)),1)])):A("",!0)])]),e("div",{ref_key:"scrollContainer",ref:m,class:"flex-1 overflow-y-auto px-3 py-3 mobile:px-2 mobile:py-1.5 relative",onScroll:C},[X(De,{name:"event",tag:"div",class:"space-y-2 mobile:space-y-1.5"},{default:Ne(()=>[(l(!0),u(z,null,H(a.value,S=>(l(),ae(Is,{key:`${S.id}-${S.timestamp}`,event:S,"gradient-class":L(i)(S.session_id),"color-class":L(h)(S.session_id),"app-gradient-class":L(w)(S.source_app),"app-color-class":L(f)(S.source_app),"app-hex-color":L(o)(S.source_app)},null,8,["event","gradient-class","color-class","app-gradient-class","app-color-class","app-hex-color"]))),128))]),_:1}),a.value.length===0?(l(),u("div",Gs,[...j[4]||(j[4]=[e("div",{class:"text-4xl mobile:text-3xl mb-3"},"ðŸ”³",-1),e("p",{class:"text-lg mobile:text-base font-semibold text-[var(--theme-primary)] mb-1.5"},"No events to display",-1),e("p",{class:"text-base mobile:text-sm"},"Events will appear here as they are received",-1)])])):A("",!0)],544)]))}}),zs=Le(Ws,[["__scopeId","data-v-88450776"]]),re=F({summaryMode:"on-demand",hasAnthropicApiKey:!1}),ee=F(!1),te=F(null);function Oe(){const n=async()=>{ee.value=!0,te.value=null;try{const m=await fetch("http://localhost:4000/settings");if(!m.ok)throw new Error("Failed to load settings");const i=await m.json();re.value={summaryMode:i.summaryMode,hasAnthropicApiKey:i.hasAnthropicApiKey}}catch(m){console.error("Error loading settings:",m),te.value="Failed to load settings"}finally{ee.value=!1}},r=async m=>{ee.value=!0,te.value=null;try{const i=await fetch("http://localhost:4000/settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({summaryMode:m})});if(!i.ok)throw new Error("Failed to update settings");const h=await i.json();return re.value={summaryMode:h.settings.summaryMode,hasAnthropicApiKey:h.hasAnthropicApiKey},!0}catch(i){return console.error("Error updating settings:",i),te.value="Failed to update settings",!1}finally{ee.value=!1}},t=B(()=>re.value.summaryMode),p=B(()=>re.value.hasAnthropicApiKey);return se(()=>{n()}),{summaryMode:t,hasAnthropicApiKey:p,loading:ee,error:te,updateSummaryMode:r,loadSettings:n}}const Hs={class:"space-y-6"},Js={class:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4"},Vs={class:"flex items-center gap-2"},Ks={class:"text-lg text-blue-600 dark:text-blue-400"},Qs={class:"space-y-4"},Ys={class:"flex-1"},Xs={key:0,class:"mt-3 p-3 bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded"},Zs={class:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700"},er=["disabled"],tr=Y({__name:"SettingsPanel",emits:["close"],setup(n,{emit:r}){const{summaryMode:t,hasAnthropicApiKey:p,updateSummaryMode:m}=Oe(),i=F(t.value),h=F(!1),w=B(()=>i.value!==t.value),f=r,o=()=>{f("close")},s=async()=>{h.value=!0;let y=!0,c=[];i.value!==t.value&&(await m(i.value)?c.push(`Summary mode changed to: ${i.value}`):(y=!1,c.push("Failed to update summary mode"))),y&&c.length>0?(alert(`Settings saved!

${c.join(`
`)}`),o()):alert(y?"No changes to save.":`Error saving settings:

${c.join(`
`)}`),h.value=!1};return(y,c)=>(l(),u("div",{class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:o},[e("div",{class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4 p-6",onClick:c[3]||(c[3]=J(()=>{},["stop"]))},[e("div",{class:"flex items-center justify-between mb-6"},[c[4]||(c[4]=e("h2",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Summary Settings",-1)),e("button",{onClick:o,class:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}," âœ• ")]),e("div",Hs,[e("div",Js,[e("div",Vs,[c[5]||(c[5]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"Current mode:",-1)),e("strong",Ks,d(i.value),1)])]),e("div",Qs,[e("label",{class:R(["flex items-start gap-4 p-4 border-2 rounded-lg cursor-pointer transition-all",i.value==="realtime"?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"])},[V(e("input",{type:"radio",value:"realtime","onUpdate:modelValue":c[0]||(c[0]=E=>i.value=E),class:"mt-1"},null,512),[[ne,i.value]]),e("div",Ys,[c[7]||(c[7]=e("div",{class:"font-bold text-lg text-gray-900 dark:text-white mb-1"}," Real-time (API) ",-1)),c[8]||(c[8]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-2"}," Summaries generated during hooks (~1-2s delay per event) ",-1)),c[9]||(c[9]=e("p",{class:"text-sm font-semibold text-orange-600 dark:text-orange-400"}," ðŸ’° Cost: API usage per event ",-1)),L(p)?A("",!0):(l(),u("div",Xs,[...c[6]||(c[6]=[qe('<p class="text-sm font-semibold text-orange-800 dark:text-orange-200 mb-2"> âš ï¸ Anthropic API Key Required </p><ol class="text-xs text-orange-700 dark:text-orange-300 space-y-1 list-decimal ml-4"><li>Create <code class="bg-orange-100 dark:bg-orange-900/40 px-1 rounded">.env</code> file in project root</li><li>Add: <code class="bg-orange-100 dark:bg-orange-900/40 px-1 rounded">ANTHROPIC_API_KEY=sk-ant-...</code></li><li>Restart system: <code class="bg-orange-100 dark:bg-orange-900/40 px-1 rounded">./scripts/observability-start.sh</code></li></ol><p class="text-xs text-orange-600 dark:text-orange-400 mt-2"> Get your API key: <a href="https://console.anthropic.com/" target="_blank" class="underline">https://console.anthropic.com/</a></p>',3)])]))])],2),e("label",{class:R(["flex items-start gap-4 p-4 border-2 rounded-lg cursor-pointer transition-all",i.value==="on-demand"?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"])},[V(e("input",{type:"radio",value:"on-demand","onUpdate:modelValue":c[1]||(c[1]=E=>i.value=E),class:"mt-1"},null,512),[[ne,i.value]]),c[10]||(c[10]=e("div",{class:"flex-1"},[e("div",{class:"font-bold text-lg text-gray-900 dark:text-white mb-1"}," On-demand (Claude Code Pro) "),e("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-2"}," Generate summaries in batches via UI button "),e("p",{class:"text-sm font-semibold text-green-600 dark:text-green-400"}," âœ… Cost: Free (uses your Pro subscription) ")],-1))],2),e("label",{class:R(["flex items-start gap-4 p-4 border-2 rounded-lg cursor-pointer transition-all",i.value==="disabled"?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"])},[V(e("input",{type:"radio",value:"disabled","onUpdate:modelValue":c[2]||(c[2]=E=>i.value=E),class:"mt-1"},null,512),[[ne,i.value]]),c[11]||(c[11]=e("div",{class:"flex-1"},[e("div",{class:"font-bold text-lg text-gray-900 dark:text-white mb-1"}," Disabled "),e("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-2"}," No summaries generated "),e("p",{class:"text-sm font-semibold text-blue-600 dark:text-blue-400"}," âš¡ Fastest hook execution ")],-1))],2)]),e("div",Zs,[e("button",{onClick:o,class:"px-4 py-2 text-sm font-semibold text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"}," Cancel "),e("button",{onClick:s,disabled:h.value||i.value==="realtime"&&!L(p)||!w.value,class:R(["px-6 py-2 text-sm font-bold text-white rounded-lg transition-all duration-200 shadow-md hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",h.value?"bg-gray-500":"bg-gradient-to-r from-[var(--theme-primary)] to-[var(--theme-primary-dark)] hover:from-[var(--theme-primary-dark)] hover:to-[var(--theme-primary)]"])},d(h.value?"Saving...":"Save Settings"),11,er)])])])]))}}),or={class:"bg-gradient-to-r from-[var(--theme-bg-primary)] to-[var(--theme-bg-secondary)] border-b-2 border-[var(--theme-primary)] px-3 py-4 mobile:py-2 shadow-lg"},sr={class:"flex flex-wrap gap-3 items-center mobile:flex-col mobile:items-stretch"},rr={class:"flex-1 min-w-0 mobile:w-full"},ar=["value"],nr={class:"flex-1 min-w-0 mobile:w-full"},lr=["value"],ir={class:"flex-1 min-w-0 mobile:w-full"},dr=["value"],ur=["disabled","title"],cr=Y({__name:"FilterPanel",props:{filters:{},events:{}},emits:["update:filters"],setup(n,{emit:r}){const t=n,p=T=>{var b,C,x;const a=T.payload;return!!(T.hook_event_type==="SubagentStart"||T.hook_event_type==="SubagentStop"||((b=a.tool_input)==null?void 0:b.file_path)===".summary-prompt.txt"||(C=a.tool_input)!=null&&C.command&&(a.tool_input.command.includes("/events/batch-summaries")||a.tool_input.command.includes("/events/save-summary-prompt")||a.tool_input.command.includes(".summary-prompt.txt"))||(x=T.summary)!=null&&x.startsWith("[Meta-event:"))},m=B(()=>t.events.filter(T=>!T.summary&&!p(T)).length),i=r,h=F({source_apps:[],session_ids:[],hook_event_types:[]}),w=F({...t.filters}),f=F(!1),o=F(!1),{summaryMode:s}=Oe(),y=B(()=>w.value.sourceApp||w.value.sessionId||w.value.eventType),c=()=>{i("update:filters",{...w.value})},E=()=>{w.value={sourceApp:"",sessionId:"",eventType:""},c()},g=async()=>{try{const T=await fetch("http://localhost:3001/events/filter-options");T.ok&&(h.value=await T.json())}catch(T){console.error("Failed to fetch filter options:",T)}},$=T=>`Please generate concise one-sentence summaries for these hook events.

For each event, respond with ONLY valid JSON in this format:
{"id": <event_id>, "summary": "<one sentence summary>"}

Requirements for summaries:
- ONE sentence only (no period at the end)
- Focus on the key action or information
- Be specific and technical
- Keep under 15 words
- Use present tense
- No quotes or extra formatting

Events to summarize:
${T.map(b=>{const C=JSON.stringify(b.payload,null,2),x=C.length>500?C.substring(0,500)+"...":C;return`Event ID: ${b.id}
Type: ${b.hook_event_type}
Payload: ${x}
---`}).join(`

`)}

After generating the summaries, execute this bash command to update the database:
curl -X POST http://localhost:3001/events/batch-summaries \\
  -H "Content-Type: application/json" \\
  -d '{"summaries": [<your generated JSON objects here>]}'`,I=async()=>{f.value=!0;try{const T=t.events.filter(x=>!x.summary);if(T.length===0){alert("No events need summaries!"),f.value=!1;return}const a=$(T),b=await fetch("http://localhost:3001/events/save-summary-prompt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:a})});if(!b.ok)throw new Error("Failed to save prompt to file");const C=await b.json();alert(`âœ… Summary prompt saved to:
${C.filePath}

Run /process-summaries to generate summaries`)}catch(T){console.error("Error generating summaries:",T),alert("Failed to generate summaries. See console for details.")}finally{f.value=!1}};return se(()=>{g(),setInterval(()=>{g()},1e4)}),(T,a)=>(l(),u("div",or,[e("div",sr,[e("div",rr,[a[6]||(a[6]=e("label",{class:"block text-base mobile:text-sm font-bold text-[var(--theme-primary)] mb-1.5 drop-shadow-sm"}," Source App ",-1)),V(e("select",{"onUpdate:modelValue":a[0]||(a[0]=b=>w.value.sourceApp=b),onChange:c,class:"w-full px-4 py-2 mobile:px-2 mobile:py-1.5 text-base mobile:text-sm border border-[var(--theme-primary)] rounded-lg focus:ring-2 focus:ring-[var(--theme-primary)]/30 focus:border-[var(--theme-primary-dark)] bg-[var(--theme-bg-primary)] text-[var(--theme-text-primary)] shadow-md hover:shadow-lg transition-all duration-200"},[a[5]||(a[5]=e("option",{value:""},"All Sources",-1)),(l(!0),u(z,null,H(h.value.source_apps,b=>(l(),u("option",{key:b,value:b},d(b),9,ar))),128))],544),[[le,w.value.sourceApp]])]),e("div",nr,[a[8]||(a[8]=e("label",{class:"block text-base mobile:text-sm font-bold text-[var(--theme-primary)] mb-1.5 drop-shadow-sm"}," Session ID ",-1)),V(e("select",{"onUpdate:modelValue":a[1]||(a[1]=b=>w.value.sessionId=b),onChange:c,class:"w-full px-4 py-2 mobile:px-2 mobile:py-1.5 text-base mobile:text-sm border border-[var(--theme-primary)] rounded-lg focus:ring-2 focus:ring-[var(--theme-primary)]/30 focus:border-[var(--theme-primary-dark)] bg-[var(--theme-bg-primary)] text-[var(--theme-text-primary)] shadow-md hover:shadow-lg transition-all duration-200"},[a[7]||(a[7]=e("option",{value:""},"All Sessions",-1)),(l(!0),u(z,null,H(h.value.session_ids,b=>(l(),u("option",{key:b,value:b},d(b.slice(0,8))+"... ",9,lr))),128))],544),[[le,w.value.sessionId]])]),e("div",ir,[a[10]||(a[10]=e("label",{class:"block text-base mobile:text-sm font-bold text-[var(--theme-primary)] mb-1.5 drop-shadow-sm"}," Event Type ",-1)),V(e("select",{"onUpdate:modelValue":a[2]||(a[2]=b=>w.value.eventType=b),onChange:c,class:"w-full px-4 py-2 mobile:px-2 mobile:py-1.5 text-base mobile:text-sm border border-[var(--theme-primary)] rounded-lg focus:ring-2 focus:ring-[var(--theme-primary)]/30 focus:border-[var(--theme-primary-dark)] bg-[var(--theme-bg-primary)] text-[var(--theme-text-primary)] shadow-md hover:shadow-lg transition-all duration-200"},[a[9]||(a[9]=e("option",{value:""},"All Types",-1)),(l(!0),u(z,null,H(h.value.hook_event_types,b=>(l(),u("option",{key:b,value:b},d(b),9,dr))),128))],544),[[le,w.value.eventType]])]),y.value?(l(),u("button",{key:0,onClick:E,class:"px-4 py-2 mobile:px-2 mobile:py-1.5 mobile:w-full text-base mobile:text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-md transition-colors"}," Clear Filters ")):A("",!0),L(s)==="on-demand"?(l(),u("button",{key:1,onClick:I,disabled:f.value||m.value===0,class:"px-4 py-2 mobile:px-2 mobile:py-1.5 mobile:w-full text-base mobile:text-sm font-bold text-white rounded-lg transition-all duration-200 shadow-md hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed bg-gradient-to-r from-[var(--theme-primary)] to-[var(--theme-primary-dark)] hover:from-[var(--theme-primary-dark)] hover:to-[var(--theme-primary)]",title:`Generate summaries for ${m.value} events`},d(f.value?"Preparing...":`ðŸ“ Generate Summaries (${m.value})`),9,ur)):A("",!0),e("button",{onClick:a[3]||(a[3]=b=>o.value=!0),class:"px-4 py-2 mobile:px-2 mobile:py-1.5 mobile:w-full text-base mobile:text-sm font-bold text-white rounded-lg transition-all duration-200 shadow-md hover:shadow-lg bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800",title:"Summary Settings"}," âš™ï¸ Settings ")]),o.value?(l(),ae(tr,{key:0,onClose:a[4]||(a[4]=b=>o.value=!1)})):A("",!0)]))}}),mr=["title"],pr={class:"w-6 h-6 mobile:w-5 mobile:h-5 drop-shadow-sm",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},hr={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 14l-7 7m0 0l-7-7m7 7V3"},gr={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6v.01"},vr=Y({__name:"StickScrollButton",props:{stickToBottom:{type:Boolean}},emits:["toggle"],setup(n){return(r,t)=>(l(),u("button",{onClick:t[0]||(t[0]=p=>r.$emit("toggle")),class:R(["fixed bottom-6 right-6 mobile:bottom-4 mobile:right-4 p-4 mobile:p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 min-w-[44px] min-h-[44px] flex items-center justify-center border-2 transform hover:scale-110",[n.stickToBottom?"bg-gradient-to-r from-[var(--theme-primary)] to-[var(--theme-primary-light)] text-white border-[var(--theme-primary-dark)] drop-shadow-md":"bg-[var(--theme-bg-primary)] hover:bg-[var(--theme-bg-secondary)] text-[var(--theme-text-primary)] border-[var(--theme-border-primary)] hover:border-[var(--theme-primary)]"]]),title:n.stickToBottom?"Disable auto-scroll":"Enable auto-scroll"},[(l(),u("svg",pr,[n.stickToBottom?(l(),u("path",hr)):(l(),u("path",gr))]))],10,mr))}}),br={class:"min-h-screen bg-[var(--theme-bg-primary)] text-[var(--theme-text-primary)] transition-colors duration-300"},yr={class:"max-w-[1920px] mx-auto p-6 mobile:p-2 h-[calc(100vh-64px)] overflow-hidden flex flex-col"},xr={class:"flex items-center justify-between mb-6"},fr={class:"flex bg-[var(--theme-bg-tertiary)] rounded-lg p-1 border border-[var(--theme-border-primary)] shadow-inner"},kr={class:"flex-1 flex flex-col space-y-4 h-full overflow-hidden"},wr={class:"grid grid-cols-1 lg:grid-cols-3 gap-4 flex-shrink-0"},_r={class:"lg:col-span-2"},Cr={class:"lg:col-span-1 h-full"},$r={class:"flex-1 min-h-0 bg-[var(--theme-bg-secondary)] rounded-lg shadow-lg border border-[var(--theme-border-primary)] flex flex-col overflow-hidden relative"},Sr={class:"flex-1 flex items-center justify-center bg-[var(--theme-bg-secondary)] rounded-lg border border-[var(--theme-border-primary)]"},Ir=Y({__name:"Dashboard",setup(n){const r=F("monitor"),t=F({sourceApp:"",sessionId:"",eventType:""}),p=F(!0),m=F([]),i=F([]),{events:h}=Ge(),w=()=>{p.value=!p.value},f=o=>{const[s,y]=o.split(":");t.value={...t.value,sourceApp:s||"",sessionId:y||""}};return(o,s)=>(l(),u("div",br,[e("main",yr,[e("div",xr,[s[8]||(s[8]=e("h2",{class:"text-xl font-bold text-[var(--theme-text-primary)]"},"Dashboard",-1)),e("div",fr,[e("button",{onClick:s[0]||(s[0]=y=>r.value="monitor"),class:R(["px-4 py-2 rounded-md text-sm font-medium transition-all duration-200 flex items-center space-x-2",r.value==="monitor"?"bg-[var(--theme-primary)] text-white shadow-md":"text-[var(--theme-text-secondary)] hover:text-[var(--theme-text-primary)] hover:bg-[var(--theme-bg-primary)]"])},[...s[6]||(s[6]=[e("span",null,"ðŸ“Š",-1),e("span",null,"Monitor",-1)])],2),e("button",{onClick:s[1]||(s[1]=y=>r.value="deploy"),class:R(["px-4 py-2 rounded-md text-sm font-medium transition-all duration-200 flex items-center space-x-2",r.value==="deploy"?"bg-[var(--theme-primary)] text-white shadow-md":"text-[var(--theme-text-secondary)] hover:text-[var(--theme-text-primary)] hover:bg-[var(--theme-bg-primary)]"])},[...s[7]||(s[7]=[e("span",null,"ðŸš€",-1),e("span",null,"Deploy",-1)])],2)])]),V(e("div",kr,[e("div",wr,[e("div",_r,[X(ht,{events:L(h),"onUpdate:uniqueAgentIds":s[2]||(s[2]=y=>m.value=y),"onUpdate:allAgentIds":s[3]||(s[3]=y=>i.value=y)},null,8,["events"])]),e("div",Cr,[X(cr,{filters:t.value,"onUpdate:filters":s[4]||(s[4]=y=>t.value=y),events:L(h)},null,8,["filters","events"])])]),e("div",$r,[X(zs,{events:L(h),filters:t.value,"stick-to-bottom":p.value,"onUpdate:stickToBottom":s[5]||(s[5]=y=>p.value=y),"unique-app-names":m.value,"all-app-names":i.value,onSelectAgent:f},null,8,["events","filters","stick-to-bottom","unique-app-names","all-app-names"]),X(vr,{"stick-to-bottom":p.value,onToggle:w},null,8,["stick-to-bottom"])])],512),[[Me,r.value==="monitor"]]),V(e("div",Sr,[...s[9]||(s[9]=[e("div",{class:"text-center"},[e("div",{class:"text-6xl mb-4"},"ðŸš€"),e("h2",{class:"text-3xl font-bold text-[var(--theme-primary)] mb-2"},"Deployment Center"),e("p",{class:"text-[var(--theme-text-secondary)] text-lg"},"Workflow deployment features coming soon...")],-1)])],512),[[Me,r.value==="deploy"]])])]))}});export{Ir as default};
