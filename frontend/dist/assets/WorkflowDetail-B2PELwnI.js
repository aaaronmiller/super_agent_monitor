import{d as D,r as n,o as N,b as l,g as e,m as L,n as B,t as d,k as C,f as $,C as W,F as M,e as V,h as a,c as O,p as R,v as P,A as U,B as A,H as T,i as E,s as F,E as z}from"./index-CLsOCDdy.js";import{u as H}from"./sessions-SEZFvufX.js";import{u as G}from"./components-CN3Joax7.js";import{_ as q}from"./CouncilPatternSelector.vue_vue_type_script_setup_true_lang-CRaGi1j_.js";import{a as I}from"./api-mlpREBDB.js";import"./client-wxXmKtvP.js";import"./index-B9ygI19o.js";const J={class:"space-y-3"},K={class:"flex items-center justify-between"},Q={class:"flex items-center gap-2"},X={class:"text-xs text-gray-500 dark:text-gray-400"},Y=["disabled"],Z={key:0,class:"space-y-3"},ee=["value"],te={key:0,class:"grid grid-cols-2 gap-2"},se=["onClick"],oe={class:"font-medium text-sm text-gray-900 dark:text-white"},ae={class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},le={class:"flex flex-wrap gap-1 mt-2"},re={key:1,class:"bg-amber-50 dark:bg-amber-900/30 rounded-lg p-3 border border-amber-200 dark:border-amber-700"},ne=D({__name:"LocalModelSelector",props:{modelValue:{}},emits:["update:modelValue","model-config"],setup(S,{emit:h}){const w=S,k=h,o=n({available:!1,models:[],error:""}),b=n([]),v=n(w.modelValue||""),x=n(!1),u=n(!1),s=n({}),g=async()=>{x.value=!0;try{const r=await I.get("/local-models/status");o.value=r.data,b.value=r.data.models||[]}catch{o.value={available:!1,models:[],error:"Failed to connect"}}finally{x.value=!1}},f=async()=>{try{const r=await I.get("/local-models/recommended");s.value=r.data.models||{}}catch(r){console.warn("Failed to load recommendations:",r)}},i=r=>r.replace(/-mlx-4bit$/,"").replace(/-instruct$/,"").split("/").pop()||r,_=()=>{k("update:modelValue",v.value)},j=r=>{v.value=r.id,k("update:modelValue",r.id),k("model-config",r)};return N(()=>{g(),f()}),(r,m)=>(a(),l("div",J,[e("div",K,[m[2]||(m[2]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[L(" Local Model "),e("span",{class:"text-xs text-gray-400"},"(LM Studio)")],-1)),e("div",Q,[e("span",{class:B(["w-2 h-2 rounded-full",o.value.available?"bg-green-500 animate-pulse":"bg-red-500"])},null,2),e("span",X,d(o.value.available?"Connected":"Disconnected"),1),e("button",{onClick:g,class:"text-xs text-blue-500 hover:text-blue-600",disabled:x.value}," ↻ ",8,Y)])]),o.value.available?(a(),l("div",Z,[C(e("select",{"onUpdate:modelValue":m[0]||(m[0]=c=>v.value=c),onChange:_,class:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[m[3]||(m[3]=e("option",{value:""},"Select a model...",-1)),(a(!0),l(M,null,V(b.value,c=>(a(),l("option",{key:c.id,value:c.id},d(i(c.id)),9,ee))),128))],544),[[W,v.value]]),u.value?(a(),l("div",te,[(a(!0),l(M,null,V(s.value,(c,y)=>(a(),l("div",{key:y,onClick:t=>j(c),class:"cursor-pointer p-3 rounded-lg border border-gray-200 dark:border-gray-700 hover:border-blue-400 dark:hover:border-blue-500 transition-colors"},[e("h5",oe,d(c.name),1),e("p",ae,d(c.description),1),e("div",le,[(a(!0),l(M,null,V(c.bestFor,t=>(a(),l("span",{key:t,class:"px-1.5 py-0.5 text-xs rounded bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300"},d(t),1))),128))])],8,se))),128))])):$("",!0),e("button",{onClick:m[1]||(m[1]=c=>u.value=!u.value),class:"text-xs text-blue-500 hover:text-blue-600"},d(u.value?"Hide recommendations":"Show recommended models"),1)])):(a(),l("div",re,[...m[4]||(m[4]=[e("p",{class:"text-sm text-amber-700 dark:text-amber-300"},[e("span",{class:"mr-1"},"⚠️"),L(" LM Studio not detected. Start LM Studio and ensure it's running on port 1234. ")],-1)])]))]))}}),de={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ie={class:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto"},ue={class:"mb-6 border-b border-gray-200 dark:border-gray-700 pb-6"},ce={class:"mb-4"},me={key:0,class:"mt-3 pl-4 border-l-2 border-blue-200 dark:border-blue-700"},pe={class:"mb-4"},ve={class:"mb-4"},be={class:"flex items-center gap-2 cursor-pointer"},xe={class:"mb-6"},ge={class:"flex items-center gap-2 cursor-pointer"},ye={class:"flex justify-end gap-3"},fe=["disabled"],ke=D({__name:"StartSessionModal",props:{workflowId:{}},emits:["close","started"],setup(S,{emit:h}){const w=S,k=h,o=H(),b=G(),v=A(),x=n(""),u=n(""),s=n(""),g=n(!0),f=n(!1),i=n(!1),_=n(!1),j=O(()=>b.componentsByCategory.orchestrator||[]),r=n(null),m=y=>{r.value=y};N(async()=>{j.value.length===0&&await b.fetchComponents({category:"orchestrator"})});async function c(){i.value=!0;try{const y=await o.createSession(w.workflowId,x.value||void 0,s.value,g.value,f.value?"e2b":"local");k("started",y.id),v.push(`/sessions/${y.id}`)}catch{alert("Failed to start session")}finally{i.value=!1}}return(y,t)=>(a(),l("div",de,[e("div",ie,[t[13]||(t[13]=e("h3",{class:"text-xl font-bold mb-4 text-gray-900 dark:text-white"},"Start New Session",-1)),e("div",ue,[R(q,{modelValue:x.value,"onUpdate:modelValue":t[0]||(t[0]=p=>x.value=p)},null,8,["modelValue"])]),e("div",ce,[e("button",{onClick:t[1]||(t[1]=p=>_.value=!_.value),class:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-blue-600"},[e("span",null,d(_.value?"▼":"▶"),1),t[7]||(t[7]=L(" Local Model Options (LM Studio) ",-1))]),_.value?(a(),l("div",me,[R(ne,{modelValue:u.value,"onUpdate:modelValue":t[2]||(t[2]=p=>u.value=p),onModelConfig:m},null,8,["modelValue"])])):$("",!0)]),e("div",pe,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Initial Prompt (Optional)",-1)),C(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=p=>s.value=p),rows:"3",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white",placeholder:"Describe the task for the agent..."},null,512),[[P,s.value]])]),e("div",ve,[e("label",be,[C(e("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=p=>g.value=p),class:"checkbox checkbox-primary"},null,512),[[U,g.value]]),t[9]||(t[9]=e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Enable Context Injection (Auto-RAG)",-1))]),t[10]||(t[10]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1 ml-6"}," Automatically search project history and inject relevant context into the agent's initial prompt. ",-1))]),e("div",xe,[e("label",ge,[C(e("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=p=>f.value=p),class:"checkbox checkbox-secondary"},null,512),[[U,f.value]]),t[11]||(t[11]=e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Run in E2B Sandbox",-1))]),t[12]||(t[12]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1 ml-6"}," Execute the agent in a secure, isolated cloud environment. ",-1))]),e("div",ye,[e("button",{onClick:t[6]||(t[6]=p=>y.$emit("close")),class:"btn btn-secondary"},"Cancel"),e("button",{onClick:c,disabled:i.value,class:"btn btn-primary"},d(i.value?"Starting...":"Start Session"),9,fe)])])]))}}),_e={class:"container mx-auto px-4 py-8"},he={key:0,class:"max-w-4xl mx-auto"},we={class:"mb-6"},$e={class:"card mb-6"},Se={class:"flex items-start justify-between mb-4"},Ce={class:"text-3xl font-bold"},Me={class:"text-gray-500 mt-1"},Ve={class:"flex items-center gap-3"},Le={class:"grid grid-cols-2 gap-4 text-sm"},je={class:"ml-2"},Be={key:0},Re={class:"ml-2"},De={class:"card"},Ne={key:0,class:"space-y-2"},Ue={class:"flex items-center justify-between"},Ee={class:"font-medium"},Fe={class:"text-sm text-gray-500"},Ie={key:1,class:"text-gray-500 text-center py-8"},Ge=D({__name:"WorkflowDetail",setup(S){const h=T();A();const w=useWorkflowsStore();useSessionsStore();const k=useComponentsStore(),o=n(null),b=n(!1);N(async()=>{const u=h.params.id;await Promise.all([w.getWorkflow(u).then(s=>o.value=s),k.fetchComponents({category:"orchestrator"})])});function v(u){return new Date(u).toLocaleString()}function x(u){return{completed:"badge-success",active:"badge-info",pending:"badge-warning",failed:"badge-error"}[u]||"badge-info"}return(u,s)=>{var f;const g=z("router-link");return a(),l("div",_e,[o.value?(a(),l("div",he,[e("div",we,[R(g,{to:"/workflows",class:"text-primary-600 hover:text-primary-700 text-sm"},{default:F(()=>[...s[2]||(s[2]=[L(" ← Back to Workflows ",-1)])]),_:1})]),e("div",$e,[e("div",Se,[e("div",null,[e("h1",Ce,d(o.value.name),1),e("p",Me,"Template: "+d(o.value.template_id),1)]),e("div",Ve,[e("span",{class:B(["badge",o.value.status==="active"?"badge-success":"badge-info"])},d(o.value.status),3),e("button",{onClick:s[0]||(s[0]=i=>b.value=!0),class:"btn btn-primary btn-sm"}," ▶ Start Session ")])]),e("div",Le,[e("div",null,[s[3]||(s[3]=e("span",{class:"text-gray-500"},"Created:",-1)),e("span",je,d(v(o.value.created_at)),1)]),o.value.updated_at?(a(),l("div",Be,[s[4]||(s[4]=e("span",{class:"text-gray-500"},"Updated:",-1)),e("span",Re,d(v(o.value.updated_at)),1)])):$("",!0)])]),e("div",De,[s[5]||(s[5]=e("h2",{class:"text-xl font-bold mb-4"},"Recent Sessions",-1)),((f=o.value.recent_sessions)==null?void 0:f.length)>0?(a(),l("div",Ne,[(a(!0),l(M,null,V(o.value.recent_sessions,i=>(a(),E(g,{key:i.id,to:`/sessions/${i.id}`,class:"block p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors"},{default:F(()=>[e("div",Ue,[e("div",null,[e("div",Ee,"Session "+d(i.id.slice(0,8)),1),e("div",Fe," Started: "+d(v(i.started_at)),1)]),e("span",{class:B(["badge",x(i.status)])},d(i.status),3)])]),_:2},1032,["to"]))),128))])):(a(),l("div",Ie," No sessions yet "))])])):$("",!0),b.value?(a(),E(ke,{key:1,"workflow-id":o.value.id,onClose:s[1]||(s[1]=i=>b.value=!1)},null,8,["workflow-id"])):$("",!0)])}}});export{Ge as default};
