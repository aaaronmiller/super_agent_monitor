import{G as R,r as y,d as q,o as B,c as O,b as r,g as e,f as g,k as C,v as j,C as z,D as E,t as l,F as N,e as D,j as G,n as $,h as n}from"./index-CLsOCDdy.js";import{a as _}from"./client-wxXmKtvP.js";import"./index-B9ygI19o.js";const W=R("memory",()=>{const F=y([]),m=y(!1),i=y(null);async function x(c){var d,u;m.value=!0,i.value=null;try{const{data:o}=await _.post("/memory/retrieve",c);return F.value=o.memories,o}catch(o){throw i.value=((u=(d=o.response)==null?void 0:d.data)==null?void 0:u.error)||"Failed to search memories",o}finally{m.value=!1}}async function w(c=50){var d,u;m.value=!0,i.value=null;try{const{data:o}=await _.get("/memory/recent",{params:{limit:c}});return F.value=o.memories,o}catch(o){throw i.value=((u=(d=o.response)==null?void 0:d.data)==null?void 0:u.error)||"Failed to fetch recent memories",o}finally{m.value=!1}}async function k(c,d=20){var u,o;m.value=!0,i.value=null;try{const{data:p}=await _.get(`/memory/session/${c}/context`,{params:{limit:d}});return p.memories}catch(p){throw i.value=((o=(u=p.response)==null?void 0:u.data)==null?void 0:o.error)||"Failed to get session context",p}finally{m.value=!1}}async function S(c,d,u=10){var o,p;m.value=!0,i.value=null;try{const{data:b}=await _.get(`/memory/workflow/${c}/history`,{params:{currentSessionId:d,limit:u}});return b.memories}catch(b){throw i.value=((p=(o=b.response)==null?void 0:o.data)==null?void 0:p.error)||"Failed to get workflow history",b}finally{m.value=!1}}async function M(c,d=5){var u,o;m.value=!0,i.value=null;try{const{data:p}=await _.get(`/memory/${c}/similar`,{params:{limit:d}});return p.memories}catch(p){throw i.value=((o=(u=p.response)==null?void 0:u.data)==null?void 0:o.error)||"Failed to find similar memories",p}finally{m.value=!1}}async function v(c){var d,u;m.value=!0,i.value=null;try{const{data:o}=await _.get(`/memory/${c}`);return o}catch(o){throw i.value=((u=(d=o.response)==null?void 0:d.data)==null?void 0:u.error)||"Failed to get memory",o}finally{m.value=!1}}async function h(c){var d,u;m.value=!0,i.value=null;try{const{data:o}=await _.get(`/memory/workflow/${c}/stats`);return o}catch(o){throw i.value=((u=(d=o.response)==null?void 0:d.data)==null?void 0:u.error)||"Failed to get stats",o}finally{m.value=!1}}return{memories:F,loading:m,error:i,searchMemories:x,fetchRecentMemories:w,getSessionContext:k,getWorkflowHistory:S,findSimilar:M,getMemory:v,getWorkflowStats:h}}),H={class:"container mx-auto px-4 py-8"},J={class:"max-w-6xl mx-auto"},K={class:"card mb-6"},P={class:"mb-4"},Q={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},X={class:"mb-4"},Y=["disabled"],Z={key:0},ee={key:1},te={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6"},se={key:1,class:"mb-6"},oe={class:"flex items-center justify-between mb-4"},ae={class:"text-gray-500"},le={class:"space-y-4"},re=["onClick"],ne={class:"flex items-start justify-between mb-3"},ie={class:"flex items-center gap-2"},de={class:"text-2xl"},ue={class:"font-medium"},ce={class:"text-sm text-gray-500"},me={class:"flex flex-col items-end gap-1"},ve={key:0,class:"badge badge-info"},pe={class:"text-gray-700 mb-3"},ye={class:"line-clamp-3"},fe={class:"flex items-center gap-2 flex-wrap"},ge={key:0,class:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded"},xe={key:1,class:"text-xs text-gray-500"},be={key:2,class:"text-center py-12 text-gray-500"},_e={class:"p-6"},he={class:"flex items-start justify-between mb-4"},we={class:"flex items-center gap-3"},ke={class:"text-3xl"},Se={class:"text-2xl font-bold"},Me={class:"text-sm text-gray-500"},Ce={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6"},Fe={class:"text-lg font-bold"},Te={key:0},je={class:"text-lg font-bold"},Ne={key:1},De={class:"text-lg font-bold"},Le={key:2},Ve={class:"text-lg font-bold"},Ue={class:"mb-6"},$e={class:"text-sm text-gray-700 whitespace-pre-wrap bg-gray-50 p-4 rounded-lg overflow-x-auto"},Ae={key:0,class:"mb-6"},Ie={class:"text-sm text-gray-700 bg-gray-50 p-4 rounded-lg overflow-x-auto"},Re={class:"mb-6"},qe={class:"flex flex-wrap gap-2"},Be={key:1},Oe={class:"space-y-2"},ze=["onClick"],Ee={class:"flex items-center justify-between mb-1"},Ge={class:"text-sm font-medium"},We={class:"text-xs badge badge-info"},He={class:"text-sm text-gray-600 line-clamp-2"},Qe=q({__name:"Memory",setup(F){const m=W(),i=y(""),x=y(""),w=y(.5),k=y(10),S=y(""),M=y([]),v=y(null),h=y([]),c=y(!1),d=y(null);B(async()=>{await u()});async function u(){c.value=!0;try{const a=await m.fetchRecentMemories(50);M.value=a.memories}catch(a){console.error("Failed to load recent memories:",a)}finally{c.value=!1}}const o=O(()=>{let a=M.value;if(i.value){const t=i.value.toLowerCase();a=a.filter(f=>f.content.toLowerCase().includes(t)||f.tags.some(s=>s.toLowerCase().includes(t))||f.toolName&&f.toolName.toLowerCase().includes(t))}return x.value&&(a=a.filter(t=>t.contentType===x.value)),a});async function p(){if(!i.value){await u();return}c.value=!0,d.value=null;try{const a=S.value.split(",").map(f=>f.trim()).filter(f=>f.length>0),t=await m.searchMemories({query:i.value,contentTypes:x.value?[x.value]:void 0,minSimilarity:w.value,limit:k.value,keywords:a.length>0?a:void 0});M.value=t.memories}catch(a){d.value=a.message||"Search failed"}finally{c.value=!1}}async function b(a){try{const t=await m.getMemory(a);v.value=t,h.value=await m.findSimilar(a,5)}catch(t){console.error("Failed to load memory details:",t)}}function V(){v.value=null,h.value=[]}function U(a){return{tool_output:"ðŸ”§",completion:"âœ…",error:"âŒ",user_input:"ðŸ’¬",system_message:"ðŸ’»"}[a]||"ðŸ“„"}function L(a){return a.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function A(a){return{error:"border-l-4 border-red-500",completion:"border-l-4 border-green-500",tool_output:"border-l-4 border-blue-500",user_input:"border-l-4 border-purple-500"}[a]||"border-l-4 border-gray-300"}function I(a){return a>=.8?"text-green-600 font-semibold":a>=.5?"text-blue-600":"text-gray-500"}return(a,t)=>{var f;return n(),r("div",H,[e("div",J,[t[22]||(t[22]=e("h1",{class:"text-3xl font-bold mb-6"},"Memory Search",-1)),e("div",K,[e("div",P,[t[6]||(t[6]=e("label",{class:"block text-sm font-medium mb-2"},"Filter / Search",-1)),C(e("textarea",{"onUpdate:modelValue":t[0]||(t[0]=s=>i.value=s),placeholder:"Type to filter instantly, or click Search for deep retrieval...",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",rows:"3"},null,512),[[j,i.value]])]),e("div",Q,[e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium mb-2"},"Content Type",-1)),C(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>x.value=s),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"},[...t[7]||(t[7]=[E('<option value="">All Types</option><option value="tool_output">Tool Outputs</option><option value="completion">Completions</option><option value="error">Errors</option><option value="user_input">User Inputs</option>',5)])],512),[[z,x.value]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium mb-2"},"Min Similarity (for Search)",-1)),C(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>w.value=s),type:"number",min:"0",max:"1",step:"0.1",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"},null,512),[[j,w.value,void 0,{number:!0}]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium mb-2"},"Limit (for Search)",-1)),C(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>k.value=s),type:"number",min:"1",max:"50",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"},null,512),[[j,k.value,void 0,{number:!0}]])])]),e("div",X,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium mb-2"},"Keywords (optional, comma-separated)",-1)),C(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>S.value=s),placeholder:"e.g., authentication, database, error",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"},null,512),[[j,S.value]])]),e("button",{onClick:p,disabled:c.value,class:"btn btn-primary w-full md:w-auto"},[c.value?(n(),r("span",ee,"Searching...")):(n(),r("span",Z,"ðŸ” Deep Search (RAG)"))],8,Y)]),d.value?(n(),r("div",te,l(d.value),1)):g("",!0),o.value.length>0?(n(),r("div",se,[e("div",oe,[t[12]||(t[12]=e("h2",{class:"text-2xl font-bold"},"Memories",-1)),e("span",ae,l(o.value.length)+" items",1)]),e("div",le,[(n(!0),r(N,null,D(o.value,s=>(n(),r("div",{key:s.id,onClick:T=>b(s.id),class:$(["card cursor-pointer hover:shadow-lg transition-shadow",A(s.contentType)])},[e("div",ne,[e("div",ie,[e("span",de,l(U(s.contentType)),1),e("div",null,[e("span",ue,l(L(s.contentType)),1),e("div",ce,l(new Date(s.timestamp).toLocaleString()),1)])]),e("div",me,[s.similarityScore!==void 0?(n(),r("span",ve,l((s.similarityScore*100).toFixed(0))+"% match ",1)):g("",!0),e("span",{class:$(["text-xs",I(s.importanceScore)])}," Importance: "+l(s.importanceScore.toFixed(2)),3)])]),e("div",pe,[e("div",ye,l(s.content),1)]),e("div",fe,[s.toolName?(n(),r("span",ge," ðŸ”§ "+l(s.toolName),1)):g("",!0),(n(!0),r(N,null,D(s.tags.slice(0,5),T=>(n(),r("span",{key:T,class:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded"},l(T),1))),128)),s.tags.length>5?(n(),r("span",xe," +"+l(s.tags.length-5)+" more ",1)):g("",!0)])],10,re))),128))])])):c.value?g("",!0):(n(),r("div",be,[...t[13]||(t[13]=[e("p",{class:"text-lg"},"No memories found",-1),e("p",{class:"text-sm mt-2"},"Try adjusting your filter or performing a Deep Search",-1)])])),v.value?(n(),r("div",{key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:V},[e("div",{class:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",onClick:t[5]||(t[5]=G(()=>{},["stop"]))},[e("div",_e,[e("div",he,[e("div",we,[e("span",ke,l(U(v.value.content_type)),1),e("div",null,[e("h3",Se,l(L(v.value.content_type)),1),e("p",Me,l(new Date(v.value.timestamp).toLocaleString()),1)])]),e("button",{onClick:V,class:"text-gray-500 hover:text-gray-700 text-2xl"}," Ã— ")]),e("div",Ce,[e("div",null,[t[14]||(t[14]=e("div",{class:"text-sm text-gray-500"},"Importance",-1)),e("div",Fe,l(v.value.importance_score.toFixed(2)),1)]),v.value.tool_name?(n(),r("div",Te,[t[15]||(t[15]=e("div",{class:"text-sm text-gray-500"},"Tool",-1)),e("div",je,l(v.value.tool_name),1)])):g("",!0),v.value.accessStats?(n(),r("div",Ne,[t[16]||(t[16]=e("div",{class:"text-sm text-gray-500"},"Access Count",-1)),e("div",De,l(v.value.accessStats.access_count),1)])):g("",!0),(f=v.value.accessStats)!=null&&f.avg_relevance?(n(),r("div",Le,[t[17]||(t[17]=e("div",{class:"text-sm text-gray-500"},"Avg Relevance",-1)),e("div",Ve,l((v.value.accessStats.avg_relevance*100).toFixed(0))+"%",1)])):g("",!0)]),e("div",Ue,[t[18]||(t[18]=e("h4",{class:"font-semibold mb-2"},"Content",-1)),e("pre",$e,l(v.value.content),1)]),Object.keys(v.value.metadata||{}).length>0?(n(),r("div",Ae,[t[19]||(t[19]=e("h4",{class:"font-semibold mb-2"},"Metadata",-1)),e("pre",Ie,l(JSON.stringify(v.value.metadata,null,2)),1)])):g("",!0),e("div",Re,[t[20]||(t[20]=e("h4",{class:"font-semibold mb-2"},"Tags",-1)),e("div",qe,[(n(!0),r(N,null,D(v.value.tags,s=>(n(),r("span",{key:s,class:"bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-sm"},l(s),1))),128))])]),h.value.length>0?(n(),r("div",Be,[t[21]||(t[21]=e("h4",{class:"font-semibold mb-2"},"Similar Memories",-1)),e("div",Oe,[(n(!0),r(N,null,D(h.value,s=>(n(),r("div",{key:s.id,onClick:T=>b(s.id),class:"p-3 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors"},[e("div",Ee,[e("span",Ge,l(L(s.contentType)),1),e("span",We,l((s.similarityScore*100).toFixed(0))+"% similar ",1)]),e("div",He,l(s.content),1)],8,ze))),128))])])):g("",!0)])])])):g("",!0)])])}}});export{Qe as default};
